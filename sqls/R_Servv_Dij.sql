/*Tener en fecha que el día viernes 02/05 estaremos realizando retenciones de IVA SERVICIOS DIGITALES correspondientes a abril, favor realizar las actualizaciones requeridas para el proceso, con relación a la fecha mencionada.
Desde ya gracias, aguardamos retorno.*/
---cantidad 19 para tarjetas de debito

    INSERT INTO GXFINDTA.TCLSET (SETRRNBEP,SETIMPCOD,SETCODMCC,SETMARCA,SETTIPTAR,SETPROTAR,SETCODSER,SETCODPRE,SETMONTO,SETRZNPRV,SETCTZAUT,
    SETLImpIn,SETMBRUTO,SETMOVPAI,SETMVCOPA,SETMVDSPA,SETMDAORI,SETCODEM,SETCICLIE,SETNOMPLA,SETRETSTA,SETUSUAC,SETFECPRO,SETFECAC,SETMRETEN,SETIMPIVA,SETIMPREN)

    SELECT A.AUTRRNBEP,'5',A.AUTCOMMCC, A.AUTMARTAR,A.AUTTIPTAR,A.AUTPROTAR, A.AUTCODSER, A.AUTCODPRE, A.AUTMONTORI, A.AUTCOMRAZ, A.AUTMONTCOT, A.AUTMONTDES, A.AUTMONTDES, A.AUTPAISORI, B.PAIISOALF2, B.PAIDSPAIS, A.AUTMONORI, A.AUTENTROL,C.PERNRODOC,C.CADNOMPLAS,'P',CURRENT USER,A.AUTTRXFCHF, A.AUTTRXFCHF,ROUND(A.AUTMONTDES*0.1),ROUND(A.AUTMONTDES*0.1),0
    FROM GXBDBPS.TSWAUT A INNER JOIN GXTRJDTA.TDGPAI B ON B.PAIIDPAIS = A.AUTPAISORI   INNER JOIN GXTRJDTA.TTDCAD C
    ON C.CDBIDCTA = A.AUTCTAOPE  AND C.CADADHERE = A.AUTPANADH   AND C.CDBCODENT = SUBSTR (A.AUTENTROL,1,4)
    WHERE A.AUTCOMMCC IN ('4814','4816','4899','5734','5735','5815','5816','5817','5818','5968','7311','7372','7399','7829','7994','7995','8220','8244','8249','8299')
    AND   A.AUTPAISORI <> 600
    AND   A.AUTTIPTAR IN ('D')
    AND   A.AUTTRXESTF = 'A'
    AND   A.AUTCODRET = '00' AND SUBSTR(A.AUTIDTRX,1,2) NOT IN ('PX')
    AND   A.AUTTRXFCHF BETWEEN '20250331' AND '20250430'
    AND   A.AUTMONTDES > 0
    AND AUTCOMRAZ NOT LIKE '%DLOCAL%'
    AND   A.AUTRRNBEP NOT IN (SELECT SETRRNBEP FROM GXFINDTA.TCLSET);

--19 RRN:
509168970063,509169083047,509169111197,509169124643,509169167999,509169214401,509169268304,
509169314255,509269335671,509269378423,509470221099,510373664803,510574450249,510975833771,
511075981833,511176471598,511477996566,511780163808,511780195848,
----cantidad 2 para tarjeta de credito

INSERT INTO GXFINDTA.TCLSET (SETRRNBEP,SETIMPCOD,SETCODMCC,SETMARCA,SETTIPTAR,SETPROTAR,SETCODSER,SETCODPRE,SETMONTO,SETRZNPRV,SETCTZAUT,
SETLImpIn,SETMBRUTO,SETMOVPAI,SETMVCOPA,SETMVDSPA,SETMDAORI,SETCODEM,SETCICLIE,SETNOMPLA,SETRETSTA,SETUSUAC,SETFECPRO,SETFECAC,SETMRETEN,SETIMPIVA,SETIMPREN)

SELECT A.AUTRRNBEP,'5', A.AUTCOMMCC, A.AUTMARTAR, A.AUTTIPTAR, A.AUTPROTAR, A.AUTCODSER, A.AUTCODPRE, A.AUTMONTORI, A.AUTCOMRAZ, A.AUTMONTCOT,A.AUTMONTDES, A.AUTMONTDES, A.AUTPAISORI,  B.PAIISOALF2,  B.PAIDSPAIS,
    A.AUTMONORI, A.AUTENTROL, C.TRJNRODOC, C.TRJNOMPLAS, 'P',  CURRENT USER,   A.AUTTRXFCHF,
    '20'||SUBSTRING(CAST (date(A.AUTFECINC + 1 days) AS char(10)),7,2)||SUBSTRING(CAST (date(A.AUTFECINC + 1 days) AS char(10)),4,2)||SUBSTRING(CAST (date(A.AUTFECINC + 1 days) AS char(10)),1,2) SETFECPRO,
    ROUND(A.AUTIMPINCO*0.1), ROUND(A.AUTIMPINCO*0.1), 0
FROM GXBDBPS.TSWAUT A INNER JOIN GXTRJDTA.TDGPAI B  ON B.PAIIDPAIS = A.AUTPAISORI INNER JOIN GXTRJDTA.TTCTRJ C ON C.TRJNROTRJ = A.AUTPANNRO
WHERE A.AUTCOMMCC  IN ( '4814''4816','4899','5734','5735','5815','5816','5817','5818','5968','7311','7372','7399','7829','7994','7995','8220','8244','8249','8299')
    AND A.AUTPAISORI <> 600
    AND A.AUTPAISORI <> 0
    AND A.AUTTIPTAR IN('C')
    AND A.AUTTRXESTF = 'A'
    AND A.AUTCODRET = '00'
    AND A.AUTTRXFCHF BETWEEN   '20250331' AND '20250430'
    AND A.AUTMONTDES > 0
    AND A.AUTCOMRAZ NOT LIKE '%DLOCAL%'
    AND A.AUTFECINC >= '2024-12-31 00:00:00.000'
    AND A.AUTFECINC < '2025-04-30 00:00:00.000'
    AND A.AUTRRNBEP not IN(SELECT SETRRNBEP FROM GXFINDTA.TCLSET);

-- 2 RRN:
509068391859
509068801635
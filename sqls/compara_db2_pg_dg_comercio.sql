-----compara las listas de codigo de comercios que tenemos en pagos digitales para sacar los datos de la db2
WITH reinge (empresa_cliente_id_interno) AS (
  VALUES
  (13879),
(12218), (11113), (11282), (10976), (10937), (11217), (11735), (20780), (10397), (3887 ), (19779), (21357), (26424), (11034), (19118), (14654), (21889), (21844), (14661), (12548), (19632), (12621), (15136), (18251), (21471), (21559), (21615), (21406), (11572), (21385), (12300), (26929), (19198), (27394), (27360), (10372), (16530), (13039), (22018), (18467), (15847), (2953 ), (19690), (21586), (27384), (18514), (19341), (22466), (24221), (24898), (15819), (10518), (10736), (12703), (11087), (22610), (17271), (3315 ), (16627), (22755), (22093), (12284), (10929), (22827), (22830), (22808), (22844), (18922), (13022), (23638), (23691), (23744), (23985), (17049), (24262), (22792), (20223), (10400), (10657), (10467), (24003), (24787), (24711), (25553), (11664), (26691), (27031), (12679), (16948), (11741), (24999), (25375), (25675), (22476), (7336 ), (21571), (10469), (16038), (13889), (26682), (13426), (26407), (13278), (19925), (10383), (27319), (14681), (27672), (17226), (10975), (3239 ), (27725), (24109), (27416), (21030), (24471), (23665), (23341), (24237),
(24618),
(21061),
(23419),
(25738),
(15959),
(20556),
(27763),
(26412),
(27299),
(11412),
(26675),
(27295),
(26979),
(24389),
(24462),
(10620),
(14896),
(27888),
(19362),
(27775),
(20358),
(26971),
(27287),
(27113),
(18936),
(11287),
(22701),
(24540),
(28198),
(23290),
(21769),
(27985),
(28440),
(28439),
(13006),
(18888),
(22760),
(27344),
(23122),
(17150),
(23735),
(20988),
(22910),
(28444),
(13752),
(28441),
(28506),
(28556)
),
legacy (id_interno) AS (
  VALUES
  (6001079),
(0200819),
(1000720),
(1000224),
(700204),
(700536),
(801196),
(6001467),
(400107),
(1000113),
(2700453),
(4100052),
(0400107),
(5500199),
(5500200),
(5500201),
(5500202),
(5500254),
(5500203),
(5500255),
(5500204),
(5500257),
(5500205),
(5500206),
(5500207),
(5500258),
(5500208),
(5500259),
(5500209),
(5500210),
(5500260),
(5500211),
(5500261),
(5500212),
(5500262),
(5500213),
(5500214),
(5500263),
(5500215),
(5500264),
(5500216),
(5500217),
(5500265),
(5500218),
(5500266),
(5500267),
(6901949),
(5500268),
(5500269),
(5500270),
(5500271),
(5500272),
(5500274),
(1900443),
(4900508),
(6500299),
(1900280),
(902180),
(6901208),
(6500300),
(100195),
(6902060),
(1400966),
(5700260),
(5500273),
(5500219),
(5500275),
(5500276),
(5500277),
(5500220),
(5500278),
(5500221),
(5500222),
(5500279),
(5500223),
(5500280),
(5500224),
(5500225),
(5500281),
(5500226),
(5500282),
(5500227),
(5500228),
(5500283),
(5500229),
(5500284),
(5500230),
(5500285),
(5500231),
(5500286),
(5500287),
(5500289),
(5500290),
(5500292),
(5500293),
(5500295),
(5500296),
(5500297),
(5500298),
(5500232),
(5500299),
(5500233),
(5500234),
(5500235),
(5500236),
(5500300),
(5500237),
(5500302),
(5500238),
(5500303),
(5500239),
(5500240),
(5500304),
(5500241),
(5500242),
(6900761),
(5500306),
(5500243),
(5500244),
(5500245),
(5500246),
(5500247),
(5500308),
(5500248),
(5500249),
(5500309),
(5500250),
(5500310),
(5500251),
(5500312),
(5500252),
(5500313),
(5500253),
(5500321),
(5500324),
(6901165),
(6901170),
(1900450),
(1401161),
(1302245),
(705869),
(705868),
(705704),
(705610),
(6901147),
(705598),
(705353),
(705214),
(705212),
(705063),
(705062),
(705060),
(704996),
(704835),
(704651),
(704650),
(704648),
(704647),
(704646),
(704645),
(704628),
(704621),
(704601),
(704570),
(704569),
(704568),
(6902005),
(704530),
(704507),
(704505),
(70449),
(704493),
(704492),
(704453),
(704452),
(704450),
(5500409),
(704439),
(704414),
(704413),
(6902004),
(6902003),
(6902116),
(5500464),
(6901869),
(704339),
(700537),
(704337),
(700538),
(704334),
(700675),
(704306),
(704267),
(700678),
(704265),
(700679),
(704264),
(6902117),
(5500424),
(5500425),
(5500426),
(5500427),
(5500428),
(5500429),
(5500430),
(5500431),
(5500432),
(5500433),
(5500434),
(5500435),
(5500436),
(5500437),
(1303006),
(6902064),
(6902100),
(5500408),
(5500423),
(704338),
(5500457),
(6901997),
(6901993),
(6901999),
(6902007),
(708135),
(6902102),
(5500465),
(6901876),
(5500438),
(700673),
(700680),
(700683),
(704179),
(704178),
(700684),
(704121),
(700685),
(704120),
(700686),
(704119),
(700687),
(704118),
(700688),
(704116),
(700689),
(700690),
(704070),
(700691),
(704069),
(700692),
(704068),
(704035),
(700693),
(700694),
(704001),
(5500439),
(5500440),
(703994),
(700707),
(700726),
(700763),
(700794),
(700875),
(700922),
(700937),
(700962),
(701042),
(701066),
(703934),
(5500441),
(701125),
(703933),
(703932),
(703876),
(703875),
(703708),
(701165),
(701166),
(701209),
(701263),
(701281),
(701315),
(701353),
(701448),
(701449),
(701454),
(701476),
(701532),
(701611),
(701617),
(701642),
(701665),
(701683),
(701699),
(701700),
(701704),
(701709),
(701710),
(701723),
(701733),
(701734),
(701735),
(701744),
(701746),
(703692),
(701767),
(703471),
(701892),
(703065),
(701933),
(702832),
(6901992),
(1900453),
(6901202),
(5000071),
(5800167),
(2800212),
(500017),
(2200070),
(400116),
(303362),
(2100876),
(5500166),
(6902071),
(0200878),
(6902044),
(4400042),
(1401566),
(6902066),
(6902073),
(6902075),
(6902085),
(6902067),
(3700276),
(302978),
(6901283),
(6901484),
(6901620),
(5800081),
(302020),
(0302586),
(2400212),
(1100490),
(6001594),
(1900452),
(6100111),
(201379),
(201380),
(303357),
(100347),
(6001615),
(6001616),
(5800170),
(1303272),
(201390),
(706886),
(303370),
(6900339),
(6900343),
(6901297),
(1303271),
(4600050),
(6001622),
(6901114),
(201318),
(6001483),
(902162),
(2301103),
(1401232),
(201392),
(4900577),
(2700413),
(1303267),
(2100879),
(2301112),
(5700270),
(6901323),
(6001639),
(6901325),
(1303285),
(902214),
(6500311),
(5800068),
(7200024),
(7200033),
(6001651),
(6901330),
(6901332),
(6901331),
(5100148),
(2200072),
(1303289),
(1303267),
(6901345),
(6001669),
(902219),
(6001656),
(902218),
(1302983),
(6901220),
(4900117),
(6500612),
(303524),
(201425),
(1200351),
(4100075),
(6001064),
(2400238),
(303407),
(5800130),
(300967),
(300982),
(301093),
(301226),
(300795),
(301308),
(301309),
(1600025),
(400128),
(301344),
(303634),
(301712),
(302394),
(302444),
(7700031),
(301147),
(301356),
(301914),
(302025),
(302037),
(302107),
(302221),
(302222),
(302223),
(302225),
(302226),
(302228),
(2000169),
(302229),
(2000159),
(6901572),
(6901588),
(6600011),
(802050),
(6901977),
(6901787),
(6901888),
(6901923),
(6902014),
(6901786),
(6901784),
(6901930),
(6901928),
(6901929),
(6901892),
(4200085),
(6902016),
(6902017),
(6902018),
(6902011),
(6902010),
(6902013),
(6902012),
(6902015),
(6901988),
(6902029),
(6902030),
(5500396),
(2000288),
(302224),
(2000192),
(302230),
(302231),
(2000154),
(302232),
(1800320),
(302233),
(303422),
(302234),
(302235),
(302236),
(303287),
(302240),
(302241),
(303286),
(302242),
(303265),
(302243),
(302322),
(302328),
(302790),
(6902090),
(302740),
(302358),
(302648),
(302377),
(302482),
(302481),
(6902098),
(6900111),
(4100082),
(6901673),
(6902091),
(6901732),
(6901783),
(303369),
(302400),
(6902103),
(303282),
(6902104),
(4900387),
(1003710),
(6902099),
(5600326),
(302244),
(5700057),
(6901990),
(303908),
(6901975),
(708270),
(700234),
(6901996),
(6901998),
(2900006),
(2900004),
(1600028),
(6901688),
(5400658),
(5500466),
(6901944),
(6902001),
(6902000),
(6901995),
(400155),
(6900928),
(301609),
(5500417),
(5700268),
(700677),
(6000841),
(5500394),
(6901690),
(6901691),
(6901692),
(400150),
(301610),
(1302785),
(100037),
(400159),
(5500418),
(5500419),
(5500420),
(400152),
(6902033),
(6901288),
(6902108),
(6901994),
(6902113),
(6902114),
(700229),
(700233),
(700485),
(700534),
(700232),
(1003649),
(1100576),
(1100577),
(7700025),
(6901520),
(5600285),
(5400661),
(3000114),
(1303464),
(700535),
(400110),
(400124),
(6901805),
(6901799),
(6901807),
(6901801),
(6901803),
(1200234),
(701123),
(5800080),
(400106),
(6902136),
(5500339),
(6901752),
(400154),
(5500398),
(5500399),
(5500400),
(5500401),
(5500402),
(5500403),
(5500404),
(5500405),
(5500406),
(5500407),
(1303582),
(6002093),
(1900178),
(1900179),
(1900183),
(1900184),
(1900305),
(1900482),
(1303598),
(6901868),
(6902006),
(6902115),
(6902023),
(6902039),
(6902040),
(6902041),
(6902042),
(6902055),
(700294),
(700223),
(700227),
(5500416),
(1200407),
(707317),
(6901517),
(400142),
(6700028),
(301612),
(301616),
(301617),
(301618),
(303094),
(6902120),
(5500413),
(5500421),
(301613),
(301619),
(302289),
(303622),
(7000012),
(6902107),
(5100128),
(303951),
(708104),
(100423),
(6900825),
(4100100),
(100351),
(5500414),
(5500415),
(5500422),
(301615),
(301620),
(400130),
(6901884),
(6902138),
(5100150),
(5100152),
(5100153),
(5100154),
(5100155),
(400114),
(6901872),
(400162),
(5800207),
(1303774),
(6902156),
(400122),
(400103),
(400117),
(400146),
(400121),
(400098),
(400127),
(400109),
(400120),
(4100105),
(1004038),
(3400042),
(6902158),
(5800208),
(708473),
(4100106),
(2301518)
)
SELECT
	s.cliclicod,
	s.sucsuccod ,
	a.cocomer,
	TRIM(LEADING '0' FROM a.cocomer) AS id_legacy,
	s.sucdencom,
	a.CNADENCOM,
	c.clirazsoc,
	c.cliruc
FROM
	gxfindta.tcmsuc s
INNER JOIN reinge co ON
	empresa_cliente_id_interno = S.CLICLICOD
LEFT JOIN gxfindta.tcocna a ON
	s.cliclicod = a.cliclicod
	AND s.sucsuccod = a.sucsuccod
LEFT JOIN gxfindta.tcmcli c ON
	s.cliclicod = c.cliclicod
WHERE EXISTS(SELECT 1 FROM legacy l WHERE l.id_interno = TRIM(LEADING '0' FROM a.COCOMER))
ORDER BY S.CLICLICOD, S.SUCSUCCOD;
-----
WITH reinge (empresa_cliente_id_interno) AS (
  VALUES (27847),
  (13879),
(12218),
(11113),
(11282),
(10976),
(10937),
(11217),
(11735),
(20780),
(10397),
(3887 ),
(19779),
(21357),
(26424),
(11034),
(19118),
(14654),
(21889),
(21844),
(14661),
(12548),
(19632),
(12621),
(15136),
(18251),
(21471),
(21559),
(21615),
(21406),
(11572),
(21385),
(12300),
(26929),
(19198),
(27394),
(27360),
(10372),
(16530),
(13039),
(22018),
(18467),
(15847),
(2953 ),
(19690),
(21586),
(27384),
(18514),
(19341),
(22466),
(24221),
(24898),
(15819),
(10518),
(10736),
(12703),
(11087),
(22610),
(17271),
(3315 ),
(16627),
(22755),
(22093),
(12284),
(10929),
(22827),
(22830),
(22808),
(22844),
(18922),
(13022),
(23638),
(23691),
(23744),
(23985),
(17049),
(24262),
(22792),
(20223),
(10400),
(10657),
(10467),
(24003),
(24787),
(24711),
(25553),
(11664),
(26691),
(27031),
(12679),
(16948),
(11741),
(24999),
(25375),
(25675),
(22476),
(7336 ),
(21571),
(10469),
(16038),
(13889),
(26682),
(13426),
(26407),
(13278),
(19925),
(10383),
(27319),
(14681),
(27672),
(17226),
(10975),
(3239 ),
(27725),
(24109),
(27416),
(21030),
(24471),
(23665),
(23341),
(24237),
(24618),
(21061),
(23419),
(25738),
(15959),
(20556),
(27763),
(26412),
(27299),
(11412),
(26675),
(27295),
(26979),
(24389),
(24462),
(10620),
(14896),
(27888),
(19362),
(27775),
(20358),
(26971),
(27287),
(27113),
(18936),
(11287),
(22701),
(24540),
(28198),
(23290),
(21769),
(27985),
(28440),
(28439),
(13006),
(18888),
(22760),
(27344),
(23122),
(17150),
(23735),
(20988),
(22910),
(28444),
(13752),
(28441),
(28506),
(28556)
),
legacy (id_interno) AS (
  VALUES
  (6001079),
(0200819),
(1000720),
(1000224),
(700204),
(700536),
(801196),
(6001467),
(400107),
(1000113),
(2700453),
(4100052),
(0400107),
(5500199),
(5500200),
(5500201),
(5500202),
(5500254),
(5500203),
(5500255),
(5500204),
(5500257),
(5500205),
(5500206),
(5500207),
(5500258),
(5500208),
(5500259),
(5500209),
(5500210),
(5500260),
(5500211),
(5500261),
(5500212),
(5500262),
(5500213),
(5500214),
(5500263),
(5500215),
(5500264),
(5500216),
(5500217),
(5500265),
(5500218),
(5500266),
(5500267),
(6901949),
(5500268),
(5500269),
(5500270),
(5500271),
(5500272),
(5500274),
(1900443),
(4900508),
(6500299),
(1900280),
(902180),
(6901208),
(6500300),
(100195),
(6902060),
(1400966),
(5700260),
(5500273),
(5500219),
(5500275),
(5500276),
(5500277),
(5500220),
(5500278),
(5500221),
(5500222),
(5500279),
(5500223),
(5500280),
(5500224),
(5500225),
(5500281),
(5500226),
(5500282),
(5500227),
(5500228),
(5500283),
(5500229),
(5500284),
(5500230),
(5500285),
(5500231),
(5500286),
(5500287),
(5500289),
(5500290),
(5500292),
(5500293),
(5500295),
(5500296),
(5500297),
(5500298),
(5500232),
(5500299),
(5500233),
(5500234),
(5500235),
(5500236),
(5500300),
(5500237),
(5500302),
(5500238),
(5500303),
(5500239),
(5500240),
(5500304),
(5500241),
(5500242),
(6900761),
(5500306),
(5500243),
(5500244),
(5500245),
(5500246),
(5500247),
(5500308),
(5500248),
(5500249),
(5500309),
(5500250),
(5500310),
(5500251),
(5500312),
(5500252),
(5500313),
(5500253),
(5500321),
(5500324),
(6901165),
(6901170),
(1900450),
(1401161),
(1302245),
(705869),
(705868),
(705704),
(705610),
(6901147),
(705598),
(705353),
(705214),
(705212),
(705063),
(705062),
(705060),
(704996),
(704835),
(704651),
(704650),
(704648),
(704647),
(704646),
(704645),
(704628),
(704621),
(704601),
(704570),
(704569),
(704568),
(6902005),
(704530),
(704507),
(704505),
(704494),
(704493),
(704492),
(704453),
(704452),
(704450),
(5500409),
(704439),
(704414),
(704413),
(6902004),
(6902003),
(6902116),
(5500464),
(6901869),
(704339),
(700537),
(704337),
(700538),
(704334),
(700675),
(704306),
(704267),
(700678),
(704265),
(700679),
(704264),
(6902117),
(5500424),
(5500425),
(5500426),
(5500427),
(5500428),
(5500429),
(5500430),
(5500431),
(5500432),
(5500433),
(5500434),
(5500435),
(5500436),
(5500437),
(1303006),
(6902064),
(6902100),
(5500408),
(5500423),
(704338),
(5500457),
(6901997),
(6901993),
(6901999),
(6902007),
(708135),
(6902102),
(5500465),
(6901876),
(5500438),
(700673),
(700680),
(700683),
(704179),
(704178),
(700684),
(704121),
(700685),
(704120),
(700686),
(704119),
(700687),
(704118),
(700688),
(704116),
(700689),
(700690),
(704070),
(700691),
(704069),
(700692),
(704068),
(704035),
(700693),
(700694),
(704001),
(5500439),
(5500440),
(703994),
(700707),
(700726),
(700763),
(700794),
(700875),
(700922),
(700937),
(700962),
(701042),
(701066),
(703934),
(5500441),
(701125),
(703933),
(703932),
(703876),
(703875),
(703708),
(701165),
(701166),
(701209),
(701263),
(701281),
(701315),
(701353),
(701448),
(701449),
(701454),
(701476),
(701532),
(701611),
(701617),
(701642),
(701665),
(701683),
(701699),
(701700),
(701704),
(701709),
(701710),
(701723),
(701733),
(701734),
(701735),
(701744),
(701746),
(703692),
(701767),
(703471),
(701892),
(703065),
(701933),
(702832),
(6901992),
(1900453),
(6901202),
(5000071),
(5800167),
(2800212),
(500017),
(2200070),
(400116),
(303362),
(2100876),
(5500166),
(6902071),
(0200878),
(6902044),
(4400042),
(1401566),
(6902066),
(6902073),
(6902075),
(6902085),
(6902067),
(3700276),
(302978),
(6901283),
(6901484),
(6901620),
(5800081),
(302020),
(0302586),
(2400212),
(1100490),
(6001594),
(1900452),
(6100111),
(201379),
(201380),
(303357),
(100347),
(6001615),
(6001616),
(5800170),
(1303272),
(201390),
(706886),
(303370),
(6900339),
(6900343),
(6901297),
(1303271),
(4600050),
(6001622),
(6901114),
(201318),
(6001483),
(902162),
(2301103),
(1401232),
(201392),
(4900577),
(2700413),
(1303267),
(2100879),
(2301112),
(5700270),
(6901323),
(6001639),
(6901325),
(1303285),
(902214),
(6500311),
(5800068),
(7200024),
(7200033),
(6001651),
(6901330),
(6901332),
(6901331),
(5100148),
(2200072),
(1303289),
(1303267),
(6901345),
(6001669),
(902219),
(6001656),
(902218),
(1302983),
(6901220),
(4900117),
(6500612),
(303524),
(201425),
(1200351),
(4100075),
(6001064),
(2400238),
(303407),
(5800130),
(300967),
(300982),
(301093),
(301226),
(300795),
(301308),
(301309),
(1600025),
(400128),
(301344),
(303634),
(301712),
(302394),
(302444),
(7700031),
(301147),
(301356),
(301914),
(302025),
(302037),
(302107),
(302221),
(302222),
(302223),
(302225),
(302226),
(302228),
(2000169),
(302229),
(2000159),
(6901572),
(6901588),
(6600011),
(802050),
(6901977),
(6901787),
(6901888),
(6901923),
(6902014),
(6901786),
(6901784),
(6901930),
(6901928),
(6901929),
(6901892),
(4200085),
(6902016),
(6902017),
(6902018),
(6902011),
(6902010),
(6902013),
(6902012),
(6902015),
(6901988),
(6902029),
(6902030),
(5500396),
(2000288),
(302224),
(2000192),
(302230),
(302231),
(2000154),
(302232),
(1800320),
(302233),
(303422),
(302234),
(302235),
(302236),
(303287),
(302240),
(302241),
(303286),
(302242),
(303265),
(302243),
(302322),
(302328),
(302790),
(6902090),
(302740),
(302358),
(302648),
(302377),
(302482),
(302481),
(6902098),
(6900111),
(4100082),
(6901673),
(6902091),
(6901732),
(6901783),
(303369),
(302400),
(6902103),
(303282),
(6902104),
(4900387),
(1003710),
(6902099),
(5600326),
(302244),
(5700057),
(6901990),
(303908),
(6901975),
(708270),
(700234),
(6901996),
(6901998),
(2900006),
(2900004),
(1600028),
(6901688),
(5400658),
(5500466),
(6901944),
(6902001),
(6902000),
(6901995),
(400155),
(6900928),
(301609),
(5500417),
(5700268),
(700677),
(6000841),
(5500394),
(6901690),
(6901691),
(6901692),
(400150),
(301610),
(1302785),
(100037),
(400159),
(5500418),
(5500419),
(5500420),
(400152),
(6902033),
(6901288),
(6902108),
(6901994),
(6902113),
(6902114),
(700229),
(700233),
(700485),
(700534),
(700232),
(1003649),
(1100576),
(1100577),
(7700025),
(6901520),
(5600285),
(5400661),
(3000114),
(1303464),
(700535),
(400110),
(400124),
(6901805),
(6901799),
(6901807),
(6901801),
(6901803),
(1200234),
(701123),
(5800080),
(400106),
(6902136),
(5500339),
(6901752),
(400154),
(5500398),
(5500399),
(5500400),
(5500401),
(5500402),
(5500403),
(5500404),
(5500405),
(5500406),
(5500407),
(1303582),
(6002093),
(1900178),
(1900179),
(1900183),
(1900184),
(1900305),
(1900482),
(1303598),
(6901868),
(6902006),
(6902115),
(6902023),
(6902039),
(6902040),
(6902041),
(6902042),
(6902055),
(700294),
(700223),
(700227),
(5500416),
(1200407),
(707317),
(6901517),
(400142),
(6700028),
(301612),
(301616),
(301617),
(301618),
(303094),
(6902120),
(5500413),
(5500421),
(301613),
(301619),
(302289),
(303622),
(7000012),
(6902107),
(5100128),
(303951),
(708104),
(100423),
(6900825),
(4100100),
(100351),
(5500414),
(5500415),
(5500422),
(301615),
(301620),
(400130),
(6901884),
(6902138),
(5100150),
(5100152),
(5100153),
(5100154),
(5100155),
(400114),
(6901872),
(400162),
(5800207),
(1303774),
(6902156),
(400122),
(400103),
(400117),
(400146),
(400121),
(400098),
(400127),
(400109),
(400120),
(4100105),
(1004038),
(3400042),
(6902158),
(5800208),
(708473),
(4100106),
(2301518)
)
SELECT
	s.cliclicod,
	s.sucsuccod ,
	a.cocomer,
	TRIM(LEADING '0' FROM a.cocomer) AS id_legacy,
	s.sucdencom,
	a.CNADENCOM,
	c.clirazsoc,
	c.cliruc
FROM
	gxfindta.tcmsuc s
INNER JOIN reinge co ON
	empresa_cliente_id_interno = S.CLICLICOD
LEFT JOIN gxfindta.tcocna a ON
	s.cliclicod = a.cliclicod
	AND s.sucsuccod = a.sucsuccod
LEFT JOIN gxfindta.tcmcli c ON
	s.cliclicod = c.cliclicod
WHERE EXISTS(SELECT 1 FROM legacy l WHERE l.id_interno = TRIM(LEADING '0' FROM a.COCOMER))
ORDER BY S.CLICLICOD, S.SUCSUCCOD;

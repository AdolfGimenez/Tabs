---------------------------------------------------------------------------------------------------------------------------
----------------------------localidad reingenieria
select * from GXFINDTA.TCMRCI where RCINOMCIU like '%SAN ALBERTO%';
select * from GXTRJDTA.TDGCIU WHERE CIUDSCIUD  like '%SAN ALBERTO%';
select * from GXFINDTA.TCOCIU WHERE CIUDESCRI like '%SAN ALBERTO%' ;
----------------------------------------------------------------------------------------------------------------
INSERT INTO GXFINDTA.TCMRCI
( RDECODDEP, RCICODCIU, RCICIUERP, RCINOMCIU, RCIUSULTUP, RCIFHULTUP)
VALUES
( 15, 9, '259', 'POZO COLORADO', 'U99ROJAS' , '2022-08-01 11:35:20.000');
----------------------------------------------------------------------------------------------------------------
INSERT INTO GXTRJDTA.TDGCIU
( CIUIDCIUD, DEPIDDEPT, CIUDSCIUD, CIUUSULTUP, CIUFHULTUP)
VALUES
( 9, 15, 'POZO COLORADO', 'MIGRACION ', '2020-04-23 18:00:00.000');
----------------------------------------------------------------------------------------------------------------
INSERT INTO GXFINDTA.TCOCIU
( DEPCOD, CIUCODNUE, CIUCODACT, CIUDESCRI, CIUUSULTUP, CIUFHULTUP)
VALUES
( 15, 9, '195', 'POZO COLORADO', 'U99ROJAS', '2022-08-01 11:42:07.000');
----------------------------------------------------------------------------------------------------------------
------------------------------tablas de comercios reing.
SELECT * FROM GXFINDTA.TCMCLI t2 WHERE CLIRUC = '932416-0';
SELECT * FROM GXFINDTA.TCMCLI t2 WHERE CLIDENCOM LIKE '%PETROCHA%'; -- tabla cliente reing.
SELECT * FROM GXFINDTA.TCMCLI t2 WHERE CLICLICOD = 15168;
SELECT * FROM GXFINDTA.TCMSUC t WHERE CLICLICOD = 2905  and SUCDENCOM LIKE '%BIGGIE%';--CLICLICOD = 925; --tabla de sucursales relacion con tabla de cliente.
SELECT * FROM GXFINDTA.TCMSUC t WHERE CLICLICOD = 6268;
SELECT * FROM GXFINDTA.TCOCNA t WHERE COCOMER = '1302981';---tabla de relaci?n actual y reing.
select * from gxfindta.tcocna where cliclicod = 19220;
SELECT * FROM GXFINDTA.TCOCNA WHERE CNADENCOM LIKE '%BANCO RIO%';
SELECT * FROM gxfindta.TCMSUC t WHERE SUCFECALT = '20220914';
--WHERE CLICLICOD=13110 AND SUCSUCCOD=1 AND COCOMER='8602540';
--------------sucursal que no migre
SELECT * FROM Gxfindta.tcmsuc WHERE CLICLICOD='14661' AND SUCSUCCOD='140';

UPDATE GXFINDTA.TCMSUC
    SET SUCTELEFO='0971437373', SUCTELMO1='0983568084'
WHERE CLICLICOD='14661' AND SUCSUCCOD='140';
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
select * from cliente where ClienteCodigo ='10937-1';
SELECT CLICLICOD, CLIRUC, CLIDENCOM, CLIRAZSOC FROM GXFINDTA.TCMCLI WHERE CLICLICOD = 126 ORDER BY CLICLICOD  FOR FETCH ONLY;
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----- Logs alta sucursal
SELECT b.SPRIDSEG, b.SDPSECUE, b.SDPDSPROCE , b.SDPFH FROM GXTRJDTA.TDSSPR a INNER JOIN GXTRJDTA.TDSSDP b
ON a.SPRIDSEG = b.SPRIDSEG
WHERE a.PRCIDPROCE = 'PCM026'
ORDER BY a.SPRFECHA DESC ;

SELECT * FROM gxtrjdta.TDSPrc WHERE PRCIDPROCE = 'PCM026'; -- PROCESOS
SELECT * FROM gxtrjdta.TDSSPR WHERE PRCIDPROCE = 'PCM026'  ORDER BY SPRIDSEG desc;-- CABECERA LOG
SELECT * FROM GXTRJDTA.TDSSDP WHERE SPRIDSEG  = 2069629; -- DETALLE LOG
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
/*Cambio de cuenta*/ --ADNUMCTA=cuenta credito
select * from gxbdbps.comaeaf where COCOMER ='8000002' and ADNUMCTA = '0626103507';

update gxbdbps.comaeaf set ADNUMCTA ='0626103507' where COCOMER ='0703051'
and ADNUMCTA = '10082480006';

SELECT CLICLICOD, LIQNOMTIT, LIQNROCUE FROM  GXFINDTA.tcmliq where CLICLICOD ='13613';
update GXFINDTA.tcmliq set LIQNROCUE ='1701015625' where CLICLICOD ='9258';

SELECT * FROM GXFINDTA.TCOCNA t WHERE COCOMER = '0705590';---tabla de relaci?n actual y reing.
----sistema actual
SELECT * FROM gxbdbps.comaeaf c WHERE c.COCOMER in ('0801697', '0801698', '0802106');
SELECT c.ADNUMCTA, c.COCOMER, c.CODENO FROM gxbdbps.comaeaf c WHERE c.COCOMER in ('0801697', '0801698', '0802106');
UPDATE gxbdbps.comaeaf SET ADNUMCTA ='6328722116' WHERE COCOMER in ('0701635', '8102689', '8602178');
--------------------------------------------------------------------------------------------------------------------------------------------------------
----cambio de cuenta reing. c.debito
SELECT * FROM GXFINDTA.TCLSCT WHERE SERCODI = 'INSMANCRE';
update GXFINDTA.TCLSCT set SCTNRCT ='0101015664' where SERCODI='INSMANCRE';

SELECT * FROM GXFINDTA.TCLTSB --WHERE SERCODI = 'INSMANCRE'
WHERE TSBIDOP IN ('4665177','4665455');

UPDATE GXFINDTA.TCLTSB
   SET TSBCTDE = '0101015664',
       TSBESTA = 'PE'
WHERE TSBIDOP IN ('4665177','4665455');
--------------------------------------------------------------------------------------------------------------------------------------------------------
---cambio de estado de instructivo
SELECT * FROM GXFINDTA.TCLIMC WHERE IMCIDIMC = 7; --cabezera
UPDATE GXFINDTA.TCLIMC SET IMCEST ='P' WHERE IMCIDIMC = 7;

SELECT * FROM GXFINDTA.TCLIMD WHERE IMCIDIMC = 7; ----detalle el 4 es porque esta duplicado la REFERENCING en tcltsb
UPDATE GXFINDTA.TCLIMD SET IMDTRARET =0 WHERE IMCIDIMC = 7;
tclsci--
tcoenc--codigo de banco actual|
tdgenr--nuemro de cuenta segun el rol
tclcst--servicio-'insmancre'
--fabiana fretes.
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----/*permisos reing*/
SELECT * FROM GXSEGDTA.TSGUSR where SGUSRID = 'U99OVELAR';
SELECT * FROM GXSEGDTA.TSGUSR where SGUSRID = 'U99HERNAN';
SELECT * FROM GXSEGDTA.TSGUSR where SGUSRID = 'U99SILVANA';
SELECT * FROM GXSEGDTA.TSGUSR where SGUSRID = 'U99LILIANA';
SELECT * FROM GXSEGDTA.TSGUSR where SGUSRID = 'U99VJARA';
SELECT * FROM GXSEGDTA.TSGUSR where SGUSRID = 'U99ADOLFO';
SELECT * FROM GXSEGDTA.TSGARU t WHERE SGUSRCOD IN (2892);--hernan
SELECT * FROM GXSEGDTA.TSGARU t2 WHERE SGUSRCOD IN (3826);--adolfo
INSERT INTO GXSEGDTA.TSGARU (SGROLCOD, SGSISCOD, SGUSRCOD, SGARUEXP, SGARUUSMO, SGARUFCHMO, SGARUENTRJ) VALUES (194, 21, 3826, 'N', '          ', '0001-01-01 00:00:00.000000', ' ');

/*DELETE FROM GXSEGDTA.TSGARU WHERE SGROLCOD=87 AND SGSISCOD=1 AND SGUSRCOD=3880;*/
---http://localhost:8080/accesobepsa/servlet/seguridad.

UPDATE GXSEGDTA.TSGFUN
SET SGFUNURLOB=''
WHERE SGFUNCOD=3880 AND SGSISCOD=1;

SELECT * FROM GXSEGDTA.TSGUSR where SGUSRCOD IN (7418);
select * from gxsegdta.tsgsis where SGSISCOD = '21';
SELECT * FROM GXSEGDTA.TSGARU WHERE SGUSRCOD IN (3826, 2942);
SELECT * FROM GXSEGDTA.TSGROL WHERE SGROLCOD IN (87,91,194,278);--hf
SELECT * FROM GXSEGDTA.TSGROL WHERE SGROLCOD IN (87, 136, 91, 586, 194, 278);--adolfo   586/136
SELECT * FROM GXSEGDTA.TSGROLDT;
SELECT * FROM GXSEGDTA.TSGROLDT WHERE SGROLCOD = '87' AND SGFUNCOD IN ('1001', '3880');
select * from GXSEGDTA.TSGFUN where SGFUNOBJ like '%WABM004%';
SELECT * FROM GXSEGDTA.TSGARU WHERE SGROLCOD = '203';
SELECT * FROM GXSEGDTA.TSGREX WHERE SGREXUSR IN ('3826','2942');
SELECT * FROM GXSEGDTA.TSGFUN;
select * from gxsegdta.tsggen;
select * from gxsegdta.tsgusr where SGUSRCOD='3826';
--DELETE FROM GXSEGDTA.TSGFUN WHERE SGFUNCOD=5273 AND SGSISCOD=1;

INSERT INTO GXSEGDTA.TSGFUN
(SGFUNCOD, SGSISCOD, SGFUNDES, SGFUNOBJ, SGFUNPAD, SGFUNORD, SGFUNVIS, SGFUNFILT, SGFUNTOBJ, SGFUNUSMO, SGFUNFCHMO, SGFUNCPAD, SGFUNURLOB, SGFUNTIPO)VALUES(5273, 1, 'LISTADO DE CORTE', 'WABM004', 'N', 0, 'S', 'S', 'W', 'U99HERNAN ', '2021-06-12 12:06:06.991', 1000, 'http://portal.bepsa.com.py/accesobepsa/servlet/seguridad.', 'I');
--Agregar pantalla de Historico de bloqueo a liliana Conteiro
INSERT INTO GXSEGDTA.TSGROLDT
(SGROLCOD, SGSISCOD, SGFUNCOD, SGRDTPDIS, SGRDTPUPD, SGRDTPINS, SGRDTPDEL)
VALUES(136, 1, 3990, 'S', 'N', 'N', 'N');

SELECT B.SGUSRCOD AS CODUSUARIO, B.SGUSRNOM AS USUARIO, A.SGSISCOD AS CODSISTEMA, D.SGSISDESC AS SISTEMA, A.SGROLCOD AS CODROL, C.SGROLDESC AS ROL, E.SGFUNCOD AS CODFUNCION, F.SGFUNDES AS FUNCION,
F.SGFUNOBJ AS OBJETOGX, E.SGRDTPDIS AS DISPLAY, E.SGRDTPUPD AS UPDATEE, E.SGRDTPINS AS INSERTT, E.SGRDTPDEL AS DELETEE FROM gxsegdta.TSGARU AS A
JOIN GXSEGDTA.TSGUSR AS B ON A.SGUSRCOD = B.SGUSRCOD
JOIN GXSEGDTA.TSGROL AS C ON A.SGROLCOD = C.SGROLCOD AND A.SGSISCOD = C.SGSISCOD
JOIN GXSEGDTA.TSGSIS AS D ON A.SGSISCOD = D.SGSISCOD
JOIN GXSEGDTA.TSGROLDT AS E ON A.SGROLCOD = E.SGROLCOD AND A.SGSISCOD = E.SGSISCOD
JOIN GXSEGDTA.TSGFUN AS F ON A.SGSISCOD = F.SGSISCOD AND F.SGFUNCOD = E.SGFUNCOD
--WHERE B.SGUSRNOM LIKE 'ADOLFO%'
WHERE B.SGUSRCOD = 2892
ORDER BY B.SGUSRCOD;
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-------portal
SELECT *FROM PORTAL.TPLROL;
SELECT *FROM PORTAL.TPLFNC;
SELECT *FROM PORTAL.TPLOBJF;
SELECT *FROM PORTAL.TPLURL;
SELECT *FROM PORTAL.TPLFNR;
SELECT *FROM PORTAL.TPLROL Where ROLNOM ='ADMINISTRADOR';
SELECT *FROM PORTAL.TPLFNC;
SELECT *FROM PORTAL.TPLOBJF;
SELECT *FROM PORTAL.TPLURL WHERE USERID = 'ADMINISTRA';
SELECT *FROM PORTAL.TPLFNR WHERE ROLID =1;
SELECT *FROM LOGIN.TPLMEN WHERE MENUITEMID BETWEEN 1 AND 17;
------desde tsgfun
SELECT * FROM GXSEGDTA.TSGFUN WHERE SGFUNDES LIKE '%PRESTACIONES%';
SELECT * FROM GXSEGDTA.TSGROLDT T WHERE SGFUNCOD IN (5554,5558);
SELECT * FROM GXSEGDTA.TSGROL T WHERE SGROLCOD IN (241, 248, 524, 241, 248, 524);
SELECT * FROM GXSEGDTA.TSGSIS T WHERE SGSISCOD=21;
----------------------------------------------------------------------------------------------------------------
/*ajuste de saldo waled no facturado redmine41832*/
update gxbdbps.tmctaaf set mcdisco = mclimco - (mcsafac + mcsfnve + mcsalfi + mcapcoc + mcapcoa + mccuopc + mccuopa) where MCEMISO='176';
update gxbdbps.tmctaaf set mcdiscu = mclimcu - (mccuope + mcadepe + mcapcuc + mcapcua + mcrefpe) where MCEMISO='176';

update gxbdbps.tmctaaf set mcsfnve=917881    where mcnumct=40050000011;
update gxbdbps.tmctaaf set mcsfnve=579325    where mcnumct=40050000013;
------------------------------------------------------------------------------------------
/*CIERRE ENTIDADES PREPAGA*/
select * from gxbdbps.tcieraf where ENEMISO in ('153','164','168','176','178','181','179','183') and AFFECIE='20230102';
--Sentencia de actualizacion.
UPDATE GXBDBPS.TCIERAF
SET AFFECIE = '20221215', AFFEVTO = '20221216'
where ENEMISO in ('153','164','168','176','178','181','179','183') and AFFECIE='20230102';

INSERT INTO GXBDBPS.TCIERAF (  ENEMISO,  BIBINES,  AFAFINI,  AFFECIE,  AFFEVTO,  AFULTSC)
VALUES(  '168',  '627431',  '001',  '20221215',  '20221216',  1);

INSERT INTO GXBDBPS.TCIERAF(  ENEMISO,  BIBINES,  AFAFINI,  AFFECIE,  AFFEVTO,  AFULTSC)
VALUES(  '181',  '627431',  '001',  '20221215',  '20221216',  1);

UPDATE GXBDBPS.TMENSAF   SET AFFECIE = '20221215'
where ENEMISO in ('153','164','168','176','178','181','179','183') and AFFECIE='20230102';

INSERT INTO GXBDBPS.TMENSAF(  ENEMISO,  BIBINES,  AFAFINI,  AFFECIE,  MESECUE,  MELINEA)
VALUES(  '181',  '627431',  '001',  '20230102',  1,  ' ');

INSERT INTO GXBDBPS.TMENSAF (  ENEMISO,  BIBINES,  AFAFINI,  AFFECIE,  MESECUE,  MELINEA)
VALUES (  '168',  '627431',  '001',  '20230102',  1,  ' ');
--------------------------------------------------------------------------------------------
/*CAMBIO DE TASA % PARA LA REFINANCIACION - SISTEMA DE REINGENIERIA*/
UPDATE GXTRJDTA.TDGAMC
   SET AMCTASMAX = 16.80
WHERE ENTCODENT = 1020 AND   AFICODAFI = 507 AND   MONIDMONED = 600 AND   TCAIDTCARG = 63 AND   AMCSECUE = 1;
--------------------------------------------------------------------------------------------
--portal
SELECT * FROM GXWEB.drcon180 WHERE ALIDCOM=100267 AND ALFECTR BETWEEN '20230101' AND '20230109';
SELECT * FROM LIBDEBITO.DRCONBEP WHERE LIDCOM=100267 AND LFECTR BETWEEN '20230101' AND '20230109';
SELECT * FROM GXWEB.GXLOUSU WHERE USUAID='2937900';--usuario
SELECT * FROM GXWEB.GXLOUSUDET WHERE USUCOD='10147';--detalle usuario
--------------------------------------------------------------------------------------------
/*Tareas #44785  BASE DE DATOS PARA ALTA DE PROVEEDORES COMERCIOS*/
SELECT B.CLICLICOD, B.SUCSUCCOD, A.CLIRAZSOC, A.CLIRUC, B.SUCCORREO, d.COCOMER, D.ENEMISO BANCO, ENNOMBR B_NOMBRE, d.ADNUMCTA cuenta, d.ADTICTA tipocuenta, B.SUCDIRECC
FROM GXFINDTA.TCMCLI A
JOIN GXFINDTA.TCMSUC B ON A.CLICLICOD = B.CLICLICOD
JOIN GXFINDTA.TCOCNA C ON C.CLICLICOD = B.CLICLICOD AND C.SUCSUCCOD = B.SUCSUCCOD
join GXBDBPS.COMAEAF d ON D.COCOMER = C.cocomer
JOIN gxbdbps.Gentiaf E ON D.ENEMISO = E.ENEMISO
WHERE SUBSTRING(C.COCOMER, 1, 2) < '79' OR SUBSTRING(C.COCOMER, 1, 2) = '81' or SUBSTRING(c.COCOMER, 1, 2) = '86'
ORDER BY B.CLICLICOD ASC, B.SUCSUCCOD ASC;
--1-caja de ahorro
--0-cta corriente.
---------------------------------------------------------------------------------------------
SELECT * from GXFINDTA.TCOCNA COCOMER
SUBSTRING(COCOMER, 1, 2) < '79';
SUBSTRING(COCOMER, 1, 2) = '81';
SUBSTRING(COCOMER, 1, 2) = '86';
SELECT * FROM
GXBDBPS.COMAEAF;
----------------------------------------------------------------------------------------------
Select * from gxbdbps.corubaf;-- Lista de Rubros
Select * from gxbdbps.Gentiaf;-- Entidades
--Actualiza datos del comercio COMAEAF
Select TIPACODI,ENEMISO,ENEMISO,ADNUMCTA,CONOCTA from gxbdbps.comaeaf where cocomer in ('0705742','8106656','8606099');
Update gxbdbps.comaeaf set TIPACODI = '3', ENEMISO = '146' ,ADTICTA = 1 , ADNUMCTA = '6274311460201681' ,CONOCTA = 'MARCELINO ALVAREZ SOSA' where cocomer in ('0705742','8106656','8606099');
--Actualiza datos del titular TCODPP
Select DPPTDC,DPPNDC,DPPNYA from gxbdbps.tcodpp where cocomer in ('0705742','8106656','8606099');
Update gxbdbps.tcodpp set DPPTDC = 'CI' ,DPPNDC = '2147311', DPPNYA = 'MARCELINO ALVAREZ SOSA' where cocomer in ('0705742','8106656','8606099');
/*Descripci?n Campo ? [Valor por defecto Obs
  COMAEAF
TIPO DE PAGO: TARJETA PREPAGA [TIPACODI 3|Tarjeta prepaga
ENTIDAD PAGADORA: BEPSA PAGO COMERCIOS ENEMISO Depende del valor que esta en el redmine
TIPO DE CTA: CAJA AHORRO 'ADTICTA |(0)Cta Corriente/(1)C Ahorro
CTA. COMERCIO: 6274311460201681 'ADNUMCTA Depende del valor que esta en el redmine
NOMRBE DE CTA: MARCELINO ALVAREZ SOSA CONOCTA Depende del valor que esta en el redmine
      TCODPP
TIPO DE DOCUMENTO: CEDULA DE IDENTIDAD DPPTDC RUC/CI Depende del valor que esta en el redmine
NRO DE DOCUMENTO: 2147311 DPPNDC Depende del valor que esta en el redmine
NOMBRE Y APELLIDO: MARCELINO ALVAREZ SOSA |DPPNYA Depende del valor que esta en el redmine*/
--ENTIDAD EN DATOS 3: ES CAMPO==CoEntDeB ==> COMAEAF
--------------------------------------------
--codigo de procesadora
select COCOMER, COPRSEC2, PRCODI, COPRCODI from GXBDBPS.COMA1AF  where COCOMER='6001163';

INSERT INTO GXBDBPS.COMA1AF
(COCOMER, COPRSEC2, PRCODI, COPRCODI)
VALUES('6001163', 1, '512', '269193');

INSERT INTO GXBDBPS.COMA1AF
(COCOMER, COPRSEC2, PRCODI, COPRCODI)
VALUES('6001163', 2, '508', '13300363224');
-----------------------------------------------------------------------------
----rubros
SELECT * FROM GXBDBPS.CORUBAF WHERE RUCODI='29';
UPDATE GXBDBPS.CORUBAF T
   SET T.RUDESC = 'UTILIDADES ELECTRICIDAD AGUA GAS',
       T.RUTRCC = 'R'
 WHERE T.RUCODI LIKE '29';
SELECT * FROM GXFINDTA.TCMRUB t ; --- el campo de MCC del rubro es MCCCODIGO
SELECT * FROM GXFINDTA.TCMMCC t ; --- el campo de TCC es MCCTCC
-----
--tabla titual
SELECT * FROM GXBDBPS.TCODPP T WHERE T.COCOMER IN ('1003130','1000478');
-----------------------------------------------------------------------------
/*para generar reporte de saldo de entidad credimax*/
select cuenta,mcdisco+mcdiscu disponible_actual,MCSTATS,sum(sumatoria) disponible_real from (
select hmnumct cuenta, sum(hmimpo2) sumatoria
from gxbdbps.thmovaf where hmemiso='164' and HMCODIG in ('515','510','529','501') and hmcodre='00'
group by hmnumct
union
select hmnumct cuenta, sum(hmimpo2*-1) sumatoria
from gxbdbps.thmovaf where hmemiso='164' and HMCODIG in ('002','010','005','020','070','090','001','060','040') and hmcodre='00' --and HMORIGE<>'A'
group by hmnumct
union
select mvnumct cuenta, sum(MVIMPO2) sumatoria
from gxbdbps.tmoviaf where mvemiso='164' and CMCODIG in ('515','510','529','501') and mvcodre='00'
group by mvnumct
union
select mvnumct cuenta, sum(MVIMPO2*-1) sumatoria
from gxbdbps.tmoviaf where mvemiso='164' and CMCODIG in ('002','010','005','020','070','090','001','060','040') and mvcodre='00' --and MVORIGE<>'A'
group by mvnumct
)
inner join
gxbdbps.tmctaaf on cuenta=mcnumct
group by cuenta,mcdisco+mcdiscu,MCSTATS;
----
--Ajuste Fecha de emision de tarjetas migradas enviadas en el pbtarjeta banco continental
UPDATE GXBDBPS.TMTARAF x
SET (MTFEPED) = (
SELECT t.TJTFECEMI
FROM GXBDBPS.TMTARAF s INNER JOIN GXTRJDTA.TMITJT t ON trim(t.TJTNROTJT)= trim(s.MTNUMTA) AND SUBSTRING(CAST(s.AFAFINI+1000 AS char(4)),2,3) = s.AFAFINI
WHERE t.TJTCODAFI IN (2,5,6,10,11,100,32,35,37,44,46,91,126)
AND CASE WHEN s.MTFEPED = t.TJTFECEMI THEN 'IGUALES' ELSE 'APLICAR REPAIR' END = 'APLICAR REPAIR' AND s.MTNUMTA = x.MTNUMTA)
WHERE x.MTNUMTA IN (SELECT s.MTNUMTA
FROM GXBDBPS.TMTARAF s INNER JOIN GXTRJDTA.TMITJT t ON trim(t.TJTNROTJT)= trim(s.MTNUMTA) AND SUBSTRING(CAST(s.AFAFINI+1000 AS char(4)),2,3) = s.AFAFINI
WHERE t.TJTCODAFI IN (2,5,6,10,11,100,32,35,37,44,46,91,126)
AND CASE WHEN s.MTFEPED = t.TJTFECEMI THEN 'IGUALES' ELSE 'APLICAR REPAIR' END = 'APLICAR REPAIR');

UPDATE GXTRJDTA.TTCTRJ w SET
(TRJFECEMI, TRJUSULTUP ,TRJFHULTUP ) = (SELECT t.TJTFECEMI, 'MIGRABAU', CURRENT timestamp
FROM GXTRJDTA.TTCTRJ x INNER JOIN GXTRJDTA.TMITJT t ON trim(t.TJTNROTJT)= trim(x.TRJNROTRJ) AND t.TJTCODAFI= x.TRJCODAFI
WHERE t.TJTCODAFI IN (2,5,6,10,11,100,32,35,37,44,46,91,126)
AND CASE WHEN x.TRJFECEMI = t.TJTFECEMI THEN 'IGUALES' ELSE 'APLICAR REPAIR' END = 'APLICAR REPAIR' AND x.TRJNROTRJ = w.TRJNROTRJ)
WHERE w.TRJNROTRJ IN (SELECT  x.TRJNROTRJ
FROM GXTRJDTA.TTCTRJ x INNER JOIN GXTRJDTA.TMITJT t ON trim(t.TJTNROTJT)= trim(x.TRJNROTRJ) AND t.TJTCODAFI= x.TRJCODAFI
WHERE t.TJTCODAFI IN (2,5,6,10,11,100,32,35,37,44,46,91,126)
AND CASE WHEN x.TRJFECEMI = t.TJTFECEMI THEN 'IGUALES' ELSE 'APLICAR REPAIR' END = 'APLICAR REPAIR');

UPDATE GXTRJDTA.TCOAUX SET AUXEST = 'P' WHERE  AUXEST = 'N' AND AUXTBL = 'TMTARAF' AND AUXFEHO >= '2023-06-29 22:04:00.000' AND AUXFEHO <= '2023-06-29 22:05:00.000';
--------caso set tarea 53781 y 53852
--VISUALIZA
SELECT
A.AUTRRNBEP,'5',A.AUTCOMMCC,A.AUTMARTAR,A.AUTTIPTAR,A.AUTPROTAR,A.AUTCODSER,A.AUTCODPRE,A.AUTMONTORI,A.AUTCOMRAZ,A.AUTMONTCOT,
A.AUTMONTDES,A.AUTMONTDES,A.AUTPAISORI,B.PAIISOALF2,B.PAIDSPAIS,A.AUTMONORI,A.AUTENTROL,C.PERNRODOC,C.CADNOMPLAS,'P',
    CURRENT USER,
    A.AUTTRXFCHF,
    VARCHAR_FORMAT(CURRENT TIMESTAMP,'YYYYMMDD'),
    ROUND(A.AUTMONTDES*0.1),
    ROUND(A.AUTMONTDES*0.1),
    0
FROM GXBDBPS.TSWAUT A
    INNER JOIN GXTRJDTA.TDGPAI B
        ON B.PAIIDPAIS = A.AUTPAISORI
    INNER JOIN GXTRJDTA.TTDCAD C
        ON C.CDBIDCTA = A.AUTCTAOPE
        AND C.CADADHERE = A.AUTPANADH
        AND C.CDBCODENT = SUBSTR(A.AUTENTROL,1,4)
WHERE A.AUTCOMMCC
        IN    ('4814','4816','4899','5734','5735','5815','5816','5817','5818','5968','7311','7372','7399','7829','7994','7995','8220','8244','8249','8299')
    AND A.AUTPAISORI <> 600
    AND A.AUTTIPTAR IN('D')
    AND A.AUTTRXESTF = 'A'
    AND A.AUTCODRET = '00'
    AND A.AUTTRXFCHF BETWEEN '20230601' AND '20230630'
    AND A.AUTMONTDES > 0
    AND A.AUTRRNBEP NOT IN(SELECT SETRRNBEP FROM GXFINDTA.TCLSET);

--INSERTA EN TCLSET PARA BANCO CONTINENTAL
INSERT INTO GXFINDTA.TCLSET (SETRRNBEP,SETIMPCOD,SETCODMCC,SETMARCA,SETTIPTAR,SETPROTAR,SETCODSER,SETCODPRE,SETMONTO,SETRZNPRV,SETCTZAUT,
SETLImpIn,SETMBRUTO,SETMOVPAI,SETMVCOPA,SETMVDSPA,SETMDAORI,SETCODEM,SETCICLIE,SETNOMPLA,SETRETSTA,SETUSUAC,SETFECPRO,SETFECAC,SETMRETEN,SETIMPIVA,SETIMPREN)
SELECT
A.AUTRRNBEP,'5',A.AUTCOMMCC,A.AUTMARTAR,A.AUTTIPTAR,A.AUTPROTAR,A.AUTCODSER,A.AUTCODPRE,A.AUTMONTORI,A.AUTCOMRAZ,
A.AUTMONTCOT,A.AUTMONTDES,A.AUTMONTDES,A.AUTPAISORI,B.PAIISOALF2,B.PAIDSPAIS,A.AUTMONORI,A.AUTENTROL,C.PERNRODOC,C.CADNOMPLAS,'P',
    CURRENT USER,
    A.AUTTRXFCHF,
    VARCHAR_FORMAT(CURRENT TIMESTAMP,'YYYYMMDD'),
    ROUND(A.AUTMONTDES*0.1),
    ROUND(A.AUTMONTDES*0.1),
    0
FROM GXBDBPS.TSWAUT A
    INNER JOIN GXTRJDTA.TDGPAI B
        ON B.PAIIDPAIS = A.AUTPAISORI
    INNER JOIN GXTRJDTA.TTDCAD C
        ON C.CDBIDCTA = A.AUTCTAOPE
        AND C.CADADHERE = A.AUTPANADH
        AND C.CDBCODENT = SUBSTR(A.AUTENTROL,1,4)
WHERE A.AUTCOMMCC
        IN    ('4814','4816','4899','5734','5735','5815','5816','5817','5818','5968','7311','7372','7399','7829','7994','7995','8220','8244','8249','8299')
    AND A.AUTPAISORI <> 600 --para dijitales tiene que ser distinto a 600
    AND A.AUTTIPTAR IN('D')
    AND A.AUTTRXESTF = 'A'
    AND A.AUTCODRET = '00'
    AND A.AUTTRXFCHF BETWEEN '20230601' AND '20230630'
    AND A.AUTMONTDES > 0
    AND A.AUTRRNBEP NOT IN(SELECT SETRRNBEP FROM GXFINDTA.TCLSET);
/*control pagosWS tomocat 12*/
SELECT * FROM GXTRJDTA.TMOMEP t ;
SELECT * FROM GXTRJDTA.TCOCME t;
SELECT * FROM GXBDBPS.TMOVIAF t;
-----usuario sistema facturacion control centerl
SELECT * FROM GXSEGDTA.TSGUSR r WHERE r.SGUSRID = 'U99ADOLFO';
select * from GXSEGDTA.TSGARU t WHERE t.SGUSRCOD = 3906;
---
SELECT * FROM GXSEGDTA.TSGUSR r WHERE r.SGUSRID = 'U99LUISA';
SELECT * FROM GXSEGDTA.TSGUSR r WHERE r.SGUSRID = 'U99FANAZCO';
select * from GXSEGDTA.TSGARU t WHERE t.SGUSRCOD = 3085;
select * from GXSEGDTA.TSGARU t WHERE t.SGUSRCOD = 3830;

/*INSERT INTO GXSEGDTA.TSGARU (SGROLCOD, SGSISCOD, SGUSRCOD, SGARUEXP, SGARUUSMO, SGARUFCHMO, SGARUENTRJ)
VALUES (1170, 1, 4264, 'N', '          ', '0001-01-01 00:00:00.000000', ' ');
INSERT INTO GXSEGDTA.TSGARU (SGROLCOD, SGSISCOD, SGUSRCOD, SGARUEXP, SGARUUSMO, SGARUFCHMO, SGARUENTRJ)
VALUES (91, 2, 4264, 'N', '          ', '0001-01-01 00:00:00.000000', ' ');
INSERT INTO GXSEGDTA.TSGARU (SGROLCOD, SGSISCOD, SGUSRCOD, SGARUEXP, SGARUUSMO, SGARUFCHMO, SGARUENTRJ)
VALUES (612, 21, 4264, 'N', '          ', '0001-01-01 00:00:00.000000', ' ');*/
-----
INSERT INTO GXSEGDTA.TSGARU (SGROLCOD, SGSISCOD, SGUSRCOD, SGARUEXP, SGARUUSMO, SGARUFCHMO, SGARUENTRJ) VALUES (585, 21, 3830, 'N', '          ', '0001-01-01 00:00:00.000000', ' ');
INSERT INTO GXSEGDTA.TSGARU (SGROLCOD, SGSISCOD, SGUSRCOD, SGARUEXP, SGARUUSMO, SGARUFCHMO, SGARUENTRJ) VALUES (356, 33, 3830, 'N', '          ', '0001-01-01 00:00:00.000000', ' ');

INSERT INTO GXSEGDTA.TSGARU (SGROLCOD, SGSISCOD, SGUSRCOD, SGARUEXP, SGARUUSMO, SGARUFCHMO, SGARUENTRJ) VALUES (87, 1, 3830, 'N', '          ', '0001-01-01 00:00:00.000000', ' ');
INSERT INTO GXSEGDTA.TSGARU (SGROLCOD, SGSISCOD, SGUSRCOD, SGARUEXP, SGARUUSMO, SGARUFCHMO, SGARUENTRJ) VALUES (2, 2, 3830, 'N', '          ', '0001-01-01 00:00:00.000000', ' ');
INSERT INTO GXSEGDTA.TSGARU (SGROLCOD, SGSISCOD, SGUSRCOD, SGARUEXP, SGARUUSMO, SGARUFCHMO, SGARUENTRJ) VALUES (194, 21, 3830, 'N', '          ', '0001-01-01 00:00:00.000000', ' ');
INSERT INTO GXSEGDTA.TSGARU (SGROLCOD, SGSISCOD, SGUSRCOD, SGARUEXP, SGARUUSMO, SGARUFCHMO, SGARUENTRJ) VALUES (278, 33, 3830, 'N', '          ', '0001-01-01 00:00:00.000000', ' ');

SELECT * FROM GXFINDTA.TCMTSO t ;--para ver tipo de persona
SELECT * FROM GXTRJDTA.TDGDEP;--departamentos
SELECT * FROM GXTRJDTA.TDGCIU; --ciudad
SELECT * FROM GXTRJDTA.TDGBAR t ; --barrio
------------------------------------------------------------------------------------------------------------------------
/*cambiar cedula*/
select * from LIBDEBITO.TGEMBHAF WHERE CRDOCU='4555861';

UPDATE LIBDEBITO.TGEMBHAF SET CRDOCU = '1555861        ' WHERE CRENTI = '107' AND CRSUCU = '00' AND CRCLAT = 'DIN' AND CRBINE = '627431' AND CRTARJ = '6274311070092983' AND CRDECR = 'D' AND CRNROC = 0 AND CRNCTA = '0000000000311737' AND CRNOMB = 'OLGA E CASCO        ' AND CRTDOC = ' '  AND CRVENC = 1904 AND CRNEMP = '                              ' AND CRDIRE = '                                                  ' AND CRLOCA = '                    ' AND CRTELE = '              ' AND CRLCRE = 0.00 AND CRCODN = '1' AND CRUSGE = 'U107RACHIT' AND CRHOGE = 0 AND CRFEGE = '20140424' AND CRRETO = 3 AND CRUSEJ = 'U99JORGEV ' AND CRHOEJ = 140920 AND CRFEEJ = '20140425';
UPDATE LIBDEBITO.TGEMBHAF SET CRDOCU = '1555861        ' WHERE CRENTI = '107' AND CRSUCU = '00' AND CRCLAT = 'DIN' AND CRBINE = '627431' AND CRTARJ = '6274311070166399' AND CRDECR = 'D' AND CRNROC = 0 AND CRNCTA = '0000000000311737' AND CRNOMB = 'OLGA E CASCO        ' AND CRTDOC = ' '  AND CRVENC = 2403 AND CRNEMP = '                              ' AND CRDIRE = '                                                  ' AND CRLOCA = '                    ' AND CRTELE = '              ' AND CRLCRE = 0.00 AND CRCODN = '2' AND CRUSGE = 'U107SILVA ' AND CRHOGE = 0 AND CRFEGE = '20190316' AND CRRETO = 3 AND CRUSEJ = 'U99WALTER ' AND CRHOEJ = 140915 AND CRFEEJ = '20190318';
UPDATE LIBDEBITO.TGEMBHAF SET CRDOCU = '1555861        ' WHERE CRENTI = '107' AND CRSUCU = '00' AND CRCLAT = 'DIN' AND CRBINE = '627431' AND CRTARJ = '6274311070208332' AND CRDECR = 'D' AND CRNROC = 0 AND CRNCTA = '0000000000311737' AND CRNOMB = 'OLGA E CASCO        ' AND CRTDOC = ' '  AND CRVENC = 2708 AND CRNEMP = '                              ' AND CRDIRE = '                                                  ' AND CRLOCA = '                    ' AND CRTELE = '              ' AND CRLCRE = 0.00 AND CRCODN = '2' AND CRUSGE = 'U107MARIAB' AND CRHOGE = 0 AND CRFEGE = '20220824' AND CRRETO = 0 AND CRUSEJ = 'U99GUIDOC ' AND CRHOEJ = 113713 AND CRFEEJ = '20220825';

select * from LIBDEBITO.TGEMBHAF WHERE CRDOCU='1555861';

SELECT * FROM GXTRJDTA.TDGENP where PERNRODOC='4555861';
SELECT * FROM GXTRJDTA.TDGPER where PERNRODOC='4555861';
SELECT * FROM GXBDBPS.TDCLIENTE where TDCLINRODOC='4555861';
SELECT * FROM GXBDBPS.GCLIEAF where CENUMDO='4555861';
SELECT * FROM LIBDEBITO.TGEMBHAF WHERE CRDOCU='4555861';
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---TARJETA INHABILITADA favor habilitar.
UPDATE GXTRJDTA.TTCTRJ SET TRJFORBLOQ='T' WHERE TRJNROTRJ='6274310213024747';
--ELIMINAR DICHO CLIENTE
--N?de tarjeta:456976******0236 Tareas #35781
--Ci:3256943

DELETE FROM GXBDBPS.TDEMIS
WHERE TDBINENTID='1020' AND TDBINNRO='456976' AND TDADHCTA=0 AND TDEMCTA=1 AND TDCTANRO=121021646;

DELETE FROM GXBDBPS.TDCTAAD
WHERE TDBINENTID='1020' AND TDBINNRO='456976' AND TDCTANRO=121021646 AND TDADHCTA=0;

DELETE FROM GXBDBPS.TDCTA
WHERE TDBINENTID='1020' AND TDCTANRO=121021646 AND TDBINNRO='456976';

select * from GXTRJDTA.TTDCDB
WHERE CDBIDCTA='0121021646  ' AND CDBCODENT=1020;

DELETE FROM GXTRJDTA.TTDCDB
WHERE CDBIDCTA='0121021646  ' AND CDBCODENT=1020;

DELETE FROM GXTRJDTA.TTDCAD
WHERE CDBIDCTA='0121021646  ' AND CADADHERE=0 AND CDBCODENT=1020;

DELETE FROM GXTRJDTA.TTDEMI
WHERE CDBIDCTA='0121021646  ' AND CADADHERE=0 AND CDBCODENT=1020 AND EMINROEMI=1;

--faltaria tdemisnov y notar porque ellos ya borraron de su sistema de tarjetas.
--las 3 primeras son de reing. y las otras del acutal.
--cambio de adherene de 0 a 1

DELETE FROM GXBDBPS.TDEMNOTAR
WHERE NEENTID='1020' AND NEBINNRO='456976' AND NECTANRO=5022109104 AND NEADHCTA=0 AND NEEMCTA=1 AND NENROTARJ='4569760000003974   ';

DELETE FROM GXBDBPS.TDEMISNOV
WHERE TDBINENTID='1020' AND TDBINNRO='456976' AND TDADHCTA=0 AND TDCTANRO=5022109104 AND TDEMCTA=1 AND TDNRONOV=1;

DELETE FROM GXBDBPS.TDEMIS
WHERE TDBINENTID='1020' AND TDBINNRO='456976' AND TDADHCTA=0 AND TDEMCTA=1 AND TDCTANRO=5022109104;

DELETE FROM GXBDBPS.TDCTAAD
WHERE TDBINENTID='1020' AND TDBINNRO='456976' AND TDCTANRO=5022109104 AND TDADHCTA=0;

DELETE FROM GXTRJDTA.TTDEMI
WHERE CDBIDCTA='5022109104  ' AND CADADHERE=0 AND CDBCODENT=1020 AND EMINROEMI=1;

DELETE FROM GXTRJDTA.TTDCAD
WHERE CDBIDCTA='5022109104  ' AND CADADHERE=0 AND CDBCODENT=1020;

INSERT INTO GXTRJDTA.TTDCAD
(CDBIDCTA, CADADHERE, CDBCODENT, CADNOMPLAS, CADNMBANMG, TDOIDTPDOC, PERNRODOC, CADTPADHE, CADESTADO, CADCODEMB, CADUSULTUP, CADFHULTUP, CADCODAFI, CADIDMARCA, CADIDPRODU)
VALUES('5022109104  ', 1, 1020, 'ANALIA BAREIRO P.         ', 'BAREIRO/ANALIA            ', 'CIP', '942857         ', 'P', 'A', '      ', 'MIGRACION ', '2020-07-24 17:32:16.000', 3, 'VSA', 'CLA');

INSERT INTO GXTRJDTA.TTDEMI
(CDBIDCTA, CADADHERE, CDBCODENT, EMINROEMI, EMINROTRJD, EMITIPONOV, EMITPPLA, EMIDURTRJ, EMIFECVENC, EMIVENCEMB, EMIVIGENTE, EMISITTRJD, EMIVENCIDA, EMIFECEMI, EMIFECACTI, EMIFECBAJA, EMIUSUACTI, EMIFECEMB, EMIFECREC, EMIFECPIN, EMIPROCABM, EMIORDEMB, EMIIDMOTAU, EMIMOTINAC, EMIUSUING, EMIFHING, EMIUSULTUP, EMIFHULTUP, EMICODAFI, EMIIDMARCA, EMIIDPRODU, EMIFORBLOQ, EMIRENOVAR, TBLIDTBLOQ, EMIFECBLO)
VALUES('5022109104  ', 1, 1020, 1, '4569760000003974   ', 'A', 'L', 60, 202506, '2506', 'N', 'I', 'N', '20200605', '00000000', '00000000', '          ', '00000000', '00000000', '00000000', 'N', 0, 0, 'A', 'USRCONTI  ', '2020-06-05 00:00:00.000', 'MIGRACION ', '2020-07-24 17:47:07.000', 3, 'VSA', 'CLA', ' ', 'S', ' ', '        ');

INSERT INTO GXBDBPS.TDCTAAD
(TDBINENTID, TDBINNRO, TDCTANRO, TDADHCTA, TDCLITIPDOC, TDCLINRODOC, TDADHNOMPLA, TDADHUSU, TDADHFCH, TDADHTARIN)
VALUES('1020', '456976', 5022109104, 1, 'CIP', '942857         ', 'ANALIA BAREIRO P.         ', 'USRCONTI  ', '20200605', '1020000221091048   ');

INSERT INTO GXBDBPS.TDEMIS
(TDBINENTID, TDBINNRO, TDADHCTA, TDEMCTA, TDCTANRO, TDEMFECEXP, TDEMFECALT, TDEMUSALT, TDEMFECACT, TDEMUSACT, TDEMPINOFF, TDEMEST, TDESTID, TDHORAEMB, TDFECHEMB, TDUSUUPD, TDFECHUPD)
VALUES('1020', '456976', 1, 1, 5022109104, 202506, '20200605', 'USRCONTI  ', '00000000', '          ', '69D66462679E8D1E', 'I', 3, 1659, '20200605', '          ', '00000000');

INSERT INTO GXBDBPS.TDEMISNOV
(TDBINENTID, TDBINNRO, TDADHCTA, TDCTANRO, TDEMCTA, TDNRONOV, TDEMISNOV, TDFECHENT, TDUSUENT, TDESTNOV, TDFECHPROC)
VALUES('1020', '456976', 1, 5022109104, 1, 1, '1', '20200605', 'USRCONTI  ', '1', '20200605');

INSERT INTO GXBDBPS.TDEMNOTAR
(NEENTID, NEBINNRO, NECTANRO, NEADHCTA, NEEMCTA, NENROTARJ, NEFCHEXP, NROTARJCTA, NOMEMP)
VALUES('1020', '456976', 5022109104, 1, 1, '4569760000003974   ', 202506, 'VSD001             ', '                          ');


---Datos de Reingenieria
SELECT * FROM GXTRJDTA.TTDCDB ;

SELECT * FROM GXTRJDTA.TTDCAD WHERE PERNRODOC='4375257';

SELECT * FROM GXTRJDTA.TTDEMI ;
SELECT * FROM GXTRJDTA.TTDEMI WHERE EMINROTRJD = '2306710001031542';
SELECT * FROM GXTRJDTA.TTDCRE

---Datos de Sistema actual
SELECT * FROM GXBDBPS.TDCTA ;
SELECT * FROM GXBDBPS.TDCTAAD ;
SELECT * FROM GXBDBPS.TDEMIS ;
SELECT * FROM GXBDBPS.TDEMISNOV ;
SELECT * FROM GXBDBPS.TDEMNOTAR ;
SELECT * FROM GXBDBPS.TDCTAREL;
--NO EMBOZAR TARJETA BCO RIO

DELETE FROM GXTRJDTA.TTDEMI
WHERE CDBIDCTA='0126097403  ' AND CADADHERE=1 AND CDBCODENT=1040 AND EMINROEMI=1;

DELETE FROM GXTRJDTA.TTDCAD
WHERE CDBIDCTA='0126097403  ' AND CADADHERE=1 AND CDBCODENT=1040;

DELETE FROM GXTRJDTA.TTDCDB
WHERE CDBIDCTA='0126097403  ' AND CDBCODENT=1040;

---a?adir localidad en reing.
INSERT INTO GXFINDTA.TCMRCI
( RDECODDEP, RCICODCIU, RCICIUERP, RCINOMCIU, RCIUSULTUP, RCIFHULTUP
)
VALUES
( 15, 9, '259', 'POZO COLORADO', 'U99ROJAS' , '2022-08-01 11:35:20.000'
);
INSERT INTO GXTRJDTA.TDGCIU
( CIUIDCIUD, DEPIDDEPT, CIUDSCIUD, CIUUSULTUP, CIUFHULTUP
)
VALUES
( 9, 15, 'POZO COLORADO', 'MIGRACION ', '2020-04-23 18:00:00.000'
);
INSERT INTO GXFINDTA.TCOCIU
( DEPCOD, CIUCODNUE, CIUCODACT, CIUDESCRI, CIUUSULTUP, CIUFHULTUP
)
VALUES
( 15, 9, '195', 'POZO COLORADO', 'U99ROJAS', '2022-08-01 11:42:07.000'
);
-----ADHERENTE NO CORRESPONDE
DELETE FROM GXTRJDTA.TTDCAD
WHERE CDBIDCTA='7104358061  ' AND CADADHERE=0 AND CDBCODENT=1020;

DELETE FROM GXTRJDTA.TTDEMI
WHERE CDBIDCTA='7104358061  ' AND CADADHERE=0 AND CDBCODENT=1020 AND EMINROEMI=1;

INSERT INTO GXTRJDTA.TTDCAD
(CDBIDCTA, CADADHERE, CDBCODENT, CADNOMPLAS, CADNMBANMG, TDOIDTPDOC, PERNRODOC, CADTPADHE, CADESTADO, CADCODEMB, CADUSULTUP, CADFHULTUP, CADCODAFI, CADIDMARCA, CADIDPRODU)
VALUES('7104358061  ', 1, 1020, 'MARCOS GULLON R.          ', 'GULLON/MARCOS             ', 'CIP', '4903099        ', 'P', 'A', '      ', 'MIGRACION ', '2021-06-18 20:01:53.000', 1, 'DIN', 'CLA');

INSERT INTO GXTRJDTA.TTDCAD
(CDBIDCTA, CADADHERE, CDBCODENT, CADNOMPLAS, CADNMBANMG, TDOIDTPDOC, PERNRODOC, CADTPADHE, CADESTADO, CADCODEMB, CADUSULTUP, CADFHULTUP, CADCODAFI, CADIDMARCA, CADIDPRODU)
VALUES('7104358061  ', 0, 1020, 'MARCOS GULLON R.          ', 'GULLON/MARCOS             ', 'CIP', '4903099        ', 'P', 'A', '      ', 'MIGRACION ', '2021-06-18 20:01:53.000', 3, 'VSA', 'CLA');

INSERT INTO GXTRJDTA.TTDEMI
(CDBIDCTA, CADADHERE, CDBCODENT, EMINROEMI, EMINROTRJD, EMITIPONOV, EMITPPLA, EMIDURTRJ, EMIFECVENC, EMIVENCEMB, EMIVIGENTE, EMISITTRJD, EMIVENCIDA, EMIFECEMI, EMIFECACTI, EMIFECBAJA, EMIUSUACTI, EMIFECEMB, EMIFECREC, EMIFECPIN, EMIPROCABM, EMIORDEMB, EMIIDMOTAU, EMIMOTINAC, EMIUSUING, EMIFHING, EMIUSULTUP, EMIFHULTUP, EMICODAFI, EMIIDMARCA, EMIIDPRODU, EMIFORBLOQ, EMIRENOVAR, TBLIDTBLOQ, EMIFECBLO)
VALUES('7104358061  ', 1, 1020, 1, '70302071043580611  ', 'A', 'B', 60, 202506, '2506', 'N', 'I', 'N', '20200608', '20200626', '00000000', 'usrconti  ', '00000000', '00000000', '00000000', 'N', 0, 0, 'F', 'USRCONTI  ', '2020-06-08 00:00:00.000', 'MIGRACION ', '2020-10-08 14:05:51.000', 1, 'DIN', 'CLA', ' ', 'S', ' ', '00000000');

INSERT INTO GXTRJDTA.TTDEMI
(CDBIDCTA, CADADHERE, CDBCODENT, EMINROEMI, EMINROTRJD, EMITIPONOV, EMITPPLA, EMIDURTRJ, EMIFECVENC, EMIVENCEMB, EMIVIGENTE, EMISITTRJD, EMIVENCIDA, EMIFECEMI, EMIFECACTI, EMIFECBAJA, EMIUSUACTI, EMIFECEMB, EMIFECREC, EMIFECPIN, EMIPROCABM, EMIORDEMB, EMIIDMOTAU, EMIMOTINAC, EMIUSUING, EMIFHING, EMIUSULTUP, EMIFHULTUP, EMICODAFI, EMIIDMARCA, EMIIDPRODU, EMIFORBLOQ, EMIRENOVAR, TBLIDTBLOQ, EMIFECBLO)
VALUES('7104358061  ', 0, 1020, 1, '4569760000114557   ', 'A', 'L', 60, 202509, '2509', 'S', 'A', 'N', '20200916', '20201006', '00000000', 'usrconti  ', '00000000', '00000000', '00000000', 'N', 0, 4, '', 'USRCONTI  ', '2022-08-01 12:00:00.000', 'MIGRACION ', '2022-08-01 12:00:00.000', 3, 'VSA', 'CLA', ' ', 'S', ' ', '00000000');

-----Tareas #36104 VERIFICACION DE EMISION Y NOMBRE DE TARJETA CONTI

UPDATE GXBDBPS.TDCTAAD
SET TDADHNOMPLA='ANTHIA ARIAS E.'
WHERE TDBINENTID='1020' AND TDBINNRO='456976' AND TDCTANRO=6601804108 AND TDADHCTA=0;

DELETE FROM GXBDBPS.TDEMNOTAR
WHERE NEENTID='1020' AND NEBINNRO='456976' AND NECTANRO=6601804108 AND NEADHCTA=0 AND NEEMCTA=2 AND NENROTARJ='4569760001047525   ';

DELETE FROM GXBDBPS.TDEMISNOV
WHERE TDBINENTID='1020' AND TDBINNRO='456976' AND TDADHCTA=0 AND TDCTANRO=6601804108 AND TDEMCTA=2 AND TDNRONOV=1;

DELETE FROM GXBDBPS.TDEMIS
WHERE TDBINENTID='1020' AND TDBINNRO='456976' AND TDADHCTA=0 AND TDEMCTA=2 AND TDCTANRO=6601804108;

INSERT INTO GXBDBPS.TDEMIS
(TDEMCTA, TDBINENTID, TDBINNRO, TDADHCTA, TDCTANRO, TDEMFECEXP, TDEMFECALT, TDEMUSALT, TDEMFECACT, TDEMUSACT, TDEMPINOFF, TDEMEST, TDESTID, TDHORAEMB, TDFECHEMB, TDUSUUPD, TDFECHUPD)
VALUES(1, '1020', '456976', 0, 6601804108, 202708, '20220810', 'MYL       ', '00000000', '          ', '                ', 'I', 2, 0, '00000000', 'MYL       ', '20220810');

INSERT INTO GXBDBPS.TDEMISNOV
(TDBINENTID, TDBINNRO, TDADHCTA, TDCTANRO, TDEMCTA, TDNRONOV, TDEMISNOV, TDFECHENT, TDUSUENT, TDESTNOV, TDFECHPROC)
VALUES('1020', '456976', 0, 6601804108, 1, 1, '1', '20220810', 'MYL       ', '0', '00000000');

INSERT INTO GXBDBPS.TDEMNOTAR
(NEENTID, NEBINNRO, NECTANRO, NEADHCTA, NEEMCTA, NENROTARJ, NEFCHEXP, NROTARJCTA, NOMEMP)
VALUES('1020', '456976', 6601804108, 0, 1, '4569760001047525   ', 202708, '4569760001047525   ', '                          ');

DELETE FROM GXTRJDTA.TTDEMI
WHERE CDBIDCTA='6601804108  ' AND CADADHERE=0 AND CDBCODENT=1020 AND EMINROEMI=1;

DELETE FROM GXTRJDTA.TTDEMI
WHERE CDBIDCTA='6601804108  ' AND CADADHERE=0 AND CDBCODENT=1020 AND EMINROEMI=2;

INSERT INTO GXTRJDTA.TTDEMI
(CDBIDCTA, CADADHERE, CDBCODENT, EMINROEMI, EMINROTRJD, EMITIPONOV, EMITPPLA, EMIDURTRJ, EMIFECVENC, EMIVENCEMB, EMIVIGENTE, EMISITTRJD, EMIVENCIDA, EMIFECEMI, EMIFECACTI, EMIFECBAJA, EMIUSUACTI, EMIFECEMB, EMIFECREC, EMIFECPIN, EMIPROCABM, EMIORDEMB, EMIIDMOTAU, EMIMOTINAC, EMIUSUING, EMIFHING, EMIUSULTUP, EMIFHULTUP, EMICODAFI, EMIIDMARCA, EMIIDPRODU, EMIFORBLOQ, EMIRENOVAR, TBLIDTBLOQ, EMIFECBLO)
VALUES('6601804108  ', 0, 1020, 1, '4569760001047525   ', 'A', 'L', 60, 202708, '2708', 'N', 'I', 'N', '20220810', '00000000', '00000000', '          ', '00000000', '00000000', '00000000', 'S', 8011, 1, 'A', 'MYL       ', '2022-08-10 15:25:26.000', 'MIGRACION ', '2022-08-11 08:30:13.000', 3, 'VSA', 'CLA', ' ', 'S', ' ', '00000000');

UPDATE GXTRJDTA.TTDCAD
SET CADNOMPLAS='ANTHIA ARIAS E.'
WHERE CDBIDCTA='6601804108  ' AND CADADHERE=0 AND CDBCODENT=1020;

UPDATE GXTRJDTA.TCADEC
SET DECNOMPLA='ANTHIA ARIAS E.           '
WHERE CRTFHCORTE='2022-08-11 11:15:52.000' AND CRTSECUE=1 AND PRCIDPROCE='PABM010   ' AND DECNROTRJ='4569760001047525   ' AND DECNRODET=1;

UPDATE GXTRJDTA.TCADEC
SET DECNOMPLA='ANTHIA ARIAS E.           '
WHERE CRTFHCORTE='2022-08-11 11:15:52.000' AND CRTSECUE=1 AND PRCIDPROCE='PABM014   ' AND DECNROTRJ='4569760001047525   ' AND DECNRODET=1;

UPDATE GXTRJDTA.TCADEC
SET DECNOMPLA='ANTHIA ARIAS E.           '
WHERE CRTFHCORTE='2022-08-11 11:15:52.000' AND CRTSECUE=1 AND PRCIDPROCE='PABM013   ' AND DECNROTRJ='4569760001047525   ' AND DECNRODET=1;
------------------------------------------------------------------
--cambio de cuenta
--actual
/*tabla para ver historico de cambio de cuenta R.I.*/
SELECT * FROM gxfindta.tCMAPR where CLICLICOD = 19733;
-------------------------------------------------------------------
select * from gxbdbps.comaeaf where COCOMER ='0301757'
and ADNUMCTA = '0626103507';

update gxbdbps.comaeaf set ADNUMCTA ='0626103507' where COCOMER ='0703051'
and ADNUMCTA = '10082480006';

--reig.
SELECT * FROM  GXFINDTA.tcmliq where CLICLICOD ='13520';
update GXFINDTA.tcmliq set LIQNROCUE ='0626103507' where CLICLICOD ='13520';
---TABLA DE SUCURSALES
SELECT * FROM  GXFINDTA.TCMSUC where SUCDENCOM like '%LA FORTUNA%';
--TABLA DE COMERCIOS REING
SELECT * FROM  GXFINDTA.tcmliq where CLICLICOD ='13520';
update GXFINDTA.tcmliq set LIQNROCUE='0626103507' where CLICLICOD ='13520';
---TABLA DE CRUCE
SELECT * FROM  GXFINDTA.tcocna where COCOMER='0302907';
--CAMBIO DE TIPO DE CUENTA
SELECT * FROM  GXFINDTA.tcmliq where CLICLICOD ='13520';
update GXFINDTA.tcmliq set LIQTIPCUE ='CA' where CLICLICOD ='13520';
**********************************************************************************************************************************************************************************
--cambio de vencimineto.
UPDATE GXTRJDTA.TTCTRJ
SET TRJVALHAS=202708, TRJVALHASE='2708', TRJNMBANMG='VARGAS/EMILIO'
WHERE TRJNROTRJ='5303990000000039';

UPDATE GXBDBPS.TMTARAF
SET MTFEVEN=2708
WHERE MTNUMTA='5303990000000039';
**********************************************************************************************************************************************************************************
--BRAHIAN ORTIZ
select * from gxbdbps.tmtaraf where CENUMDO ='6582482' and MCNUMCT = '040050001394';
Delete FROM gxbdbps.tmtaraf where CENUMDO ='6582482' and MCNUMCT = '040050001394';

select * from gxbdbps.tmctaaf where  MCNUMDO ='6582482' and mcnumct= '040050001394';
Delete FROM gxbdbps.tmctaaf where  MCNUMDO ='6582482' and mcnumct= '040050001394';

--tmpnum por restrigci?n referencial
select * from gxbdbps.tmpnum where MCNUMCT in ('040050000935','040050001394');
delete FROM gxbdbps.tmpnum where MCNUMCT in ('040050000935','040050001394');

select * from adolfolib.tmctaaf where MCNUMDO in ('6582482','4040744');
select * from adolfolib.tmtaraf where CENUMDO in ('6582482','4040744');

select * from gxbdbps.tmpnum where MCNUMCT in ('040050000935','040050001394');
delete FROM gxbdbps.tmpnum where MCNUMCT in ('040050000935','040050001394');

---------------------------------------------------------de reing.
SELECT * FROM GXTRJDTA.TTCTRJ WHERE CTAIDCTA IN ('40050000935','40050001394');
DELETE FROM GXTRJDTA.TTCTRJ WHERE TRJNROTRJ='5476970000008761   ';
DELETE FROM GXTRJDTA.TTCTRJ WHERE TRJNROTRJ='5476970000013357   ';

SELECT * FROM GXTRJDTA.TTCCTA WHERE CTAIDCTA IN ('40050000935','40050001394');
DELETE FROM GXTRJDTA.TTCCTA WHERE CTAIDCTA=40050000935;
DELETE FROM GXTRJDTA.TTCCTA WHERE CTAIDCTA=40050001394;
---------------------------inactivar cuenta
Select * from GXTRJDTA.TTDEMI WHERE CDBIDCTA='6406314255  ' AND CADADHERE=0 AND CDBCODENT=1020 AND EMINROEMI=1;

UPDATE GXTRJDTA.TTDEMI
SET EMISITTRJD='I'
WHERE CDBIDCTA='6406314255  ' AND CADADHERE=0 AND CDBCODENT=1020 AND EMINROEMI=1;

UPDATE GXTRJDTA.TTDEMI
SET EMISITTRJD='I'
WHERE CDBIDCTA='6621270371  ' AND CADADHERE=0 AND CDBCODENT=1020 AND EMINROEMI=1;
--ELIMINACION DE CTA/ TARJETA en esste caso credit
SELECT * FROM GXBDBPS.TMTARAF WHERE CENUMDO ='4234872' and MCNUMCT = '40050001536';
DELETE FROM GXBDBPS.TMTARAF WHERE CENUMDO ='4234872' and MCNUMCT = '40050001536';
SELECT * FROM GXBDBPS.TMCTAAF WHERE  MCNUMDO ='4234872' and MCNUMCT= '040050001536';
DELETE FROM GXBDBPS.TMCTAAF WHERE  MCNUMDO ='4234872' and MCNUMCT= '040050001536';
SELECT * FROM GXBDBPS.TMPNUM WHERE MCNUMCT in ('40050001536');
DELETE FROM GXBDBPS.TMPNUM WHERE MCNUMCT IN ('40050001536');
SELECT * FROM GXTRJDTA.TTCTRJ WHERE CTAIDCTA IN ('40050001536');
DELETE FROM GXTRJDTA.TTCTRJ WHERE CTAIDCTA IN ('40050001536');
SELECT * FROM GXTRJDTA.TTCCTA WHERE CTAIDCTA IN ('40050001536');
DELETE FROM GXTRJDTA.TTCCTA WHERE CTAIDCTA IN ('40050001536');
---------------------------------------------------------------------------------------------------
--TARJETA INHABILITADA - TRASMISION CONTINENTAL
UPDATE GXTRJDTA.TTCTRJ
SET TRJFORBLOQ='T'
WHERE TRJNROTRJ='5303990000001805   ';
---------------------------------------------------------------------------------------------------
-----correcion de banda magnetica
UPDATE GXTRJDTA.TTDCAD
SET CADNMBANMG='NUNEZ/MARIA'
WHERE CDBIDCTA='1424318718  ' AND CADADHERE=0 AND CDBCODENT=1020;
---------------------------------------------------------------------------------------------------
--incluir c?digo de comercio en la lista negra
SELECT * FROM GXAUTDTA.TAUBKL;
INSERT INTO GXAUTDTA.TAUBKL
(
  BKLCODCO,
  BKLFECHA,
  BKLOBS
)
VALUES
(
  '402946389935859',
  20221130,
  'COMERCIO REPORTADO');
----------------------------------------------------------------------------------------------------
/*Modificaci?n masiva de costo normal_ Continental*/
/*LOS DATOS SE TOMAN DEL EXEL EN CUESTION*/
UPDATE GXBDBPS.COAFMAF SET AFMONTO = 90909 		WHERE AFCOMER = '5600178';
UPDATE GXBDBPS.COAFMAF SET AFMONTO = 90909 		WHERE AFCOMER = '5700134';
--------------------------------------------------------------------------------------------------------
/*Elimina facturas generadas de manera incorrecta*/
--facturas cabecera
Select * from gxopera.factura where FACFECH = '20221205' AND factnro between 10030063851 and 10030064563;
DELETE from gxopera.factura where FACFECH = '20221205' AND factnro between 10030063851 and 10030064563;
--detalles de facturas
Select * from gxopera.factura1 where factimbr = '15662553' and factnro between 10030063851 and 10030064563;
DELETE from gxopera.factura1 where factimbr = '15662553' and factnro between 10030063851 and 10030064563;
--ver numerador de facturas y actualizar
Select * from gxopera.factura2 where FACTURA2TIMBRADO = '15662553' and FACTURA2TIPO = 'NOR';
update gxopera.factura2 set FACTURA2NRO=10030063850 where FACTURA2TIMBRADO = '15662553' and FACTURA2TIPO = 'NOR';
----------------------------------------------------------------------------------------------------------
--ruteo transaccional
-- Se elimina el destcod 530 porque ya existe 540 vsa correcto
select * from gxbdbps.coma3af where  MTID='VSA' and cocomer in ('0704843') and DESTCOD='530';
delete FROM gxbdbps.coma3af where  MTID='VSA' and cocomer in ('0704843') and DESTCOD='530';

-- Se elimina el destcod 540 porque ya existe 530 MST correcto
select * from gxbdbps.coma3af where MTID='MST' and cocomer='1302479' and DESTCOD='540';
delete FROM gxbdbps.coma3af where MTID='MST' and cocomer='1302479' and DESTCOD='540';
--------------------------------------------
/*ver tipo de pos*/
SELECT LFECTR fecha, LHORTR hora, LBINPR bin, LACTFJ ACTIVO, lcretr retorno, aftidesc
from libdebito.drconbep a
inner JOIN GXBDBPS.COAFMAF b ON (AFCODI=LACTFJ)
RIGHT JOIN  gxbdbps.coaftaf c ON (B.AFTICODI=C.AFTICODI)
WHERE LFECTR='20230119'
AND LACTFJ='21981504';

select * FROM gxbdbps.coaftaf; --detalle activo fijo
select * FROM gxbdbps.COAFMAF; ---maestro activo fijo

/*/*tmpnum y hstnum*/
SELECT * FROM gxbdbps.tmpnum WHERE NUMPER <'202300';
HERNANLIB/TMPNUM22
DELETE gxbdbps.tmpnum WHERE NUMPER <'202300';
SELECT * FROM gxbdbps.hstnum WHERE NUHPER <'202300';
HERNANLIB/hstnum22
DELETE gxbdbps.hstnum WHERE NUHPER <'202300'
    DELETE gxbdbps.tmpnum WHERE NUMPER <'202300'
11195145 filas suprimidas de TMPNUM en GXBDBPS.
DELETE gxbdbps.hstnum WHERE NUHPER <'202300'
3065504 filas suprimidas de HSTNUM en GXBDBPS.*/
------------------------------------------------------------------
--Baja de Dispositivos K2b Tara: http://redmine2.bepsa.com.py/issues/67053
MERGE INTO GXFINDTA.TCMDIS
USING (SELECT DISTINCT (T.CLICLICOD) AS CLIENTE, T.SUCSUCCOD AS SUCURSAL, T.DISCODIGO AS CODIGO, T.DISESTADO, T.DISFECBAJ
       FROM GXFINDTA.TCMDIS T
                JOIN GXFINDTA.TCOCNA C ON T.CLICLICOD = C.CLICLICOD AND T.SUCSUCCOD = C.SUCSUCCOD
       WHERE C.COCOMER IN ('0705928', '5500025', '5500025',
                           '5500025', '5500025', '1401082', '4800240',
                           '2500061', '5500025', '5500025', '4900461',
                           '0200948', '4900156', '3200070', '5600153',
                           '0201103', '0301687', '6900442', '0801146',
                           '0302490', '1800370', '0704915', '2300971', '5700154',
                           '1302959', '2400180', '2400180', '0302957', '0702610', '6900879',
                           '0802328', '1400862')
         AND T.DISACTCOD IN ('22989992', '22384237', '22383986', '26885134', '26887060',
                             '14624342', '14281864', '21980827', '26885135', '22980347', '21981764', '26988614', '21982178',
                             '22983109', '13730568', '26987838', '13878837', '13881993', '14048320', '14043818', '14038006',
                             '14042724', '22980161', '26887040', '21980388', '14277643', '14610861', '14717532', '22980659',
                             '19898666', '26886719', '19898398', '19999832')) AS DISPOSITIVO
ON (GXFINDTA.TCMDIS.CLICLICOD = DISPOSITIVO.CLIENTE AND GXFINDTA.TCMDIS.SUCSUCCOD = DISPOSITIVO.SUCURSAL AND GXFINDTA.TCMDIS.DISCODIGO = DISPOSITIVO.CODIGO)
WHEN MATCHED THEN
    UPDATE
    SET DISESTADO='A',
        DISFECBAJ='';
------------------------------------------
SELECT * FROM GXFINDTA.TCMDIS t WHERE DISACTCOD='21982155' ;
--DISESTADO campo para ver el estado
--DISFECBAJ fecha de baja
SELECT * FROM GXBDBPS.COAFMAF C2 WHERE C2.AFCODI;--ACTIVO | EL CAMPO AFCOMER TIEN QUE ESTAR VACI? SI ESTA EN BAJA
--------------------------------------------
UPDATE GXFINDTA.TCMDIS
SET DISESTADO='A',  DISFECBAJ=''
WHERE CLICLICOD=3068 AND SUCSUCCOD=1 AND DISCODIGO=2;
--------------------------------------------------------
--------para ver pagos chuecos api pagos.
---api pagos
SELECT * FROM (
SELECT
t.mepestado,
(SELECT count(*) FROM GXTRJDTA.TCOCME r WHERE r.CMEMOVACT = t.MEPIDMOV) relacion_leg_reing,
(SELECT count(*) FROM gxbdbps.TMOVIAF l WHERE l.MVSECUE = (SELECT r.CMEMOVANT
                                                             FROM GXTRJDTA.TCOCME r
                                                            WHERE r.CMEMOVACT = t.MEPIDMOV) ) legacy,
t.*
FROM GXTRJDTA.TMOMEP t WHERE t.MEPUSULTUP = 'USR1020WS' AND t.mepestado = 'P' ) a WHERE a.RELACION_LEG_REING = 0;
---
------para xml crear cliente sucursal new f3
SELECT a.CLICLICOD ClienteCodigo ,b.SUCSUCCOD SucursalCodigo , a.CLIDENCOM PersonaJuridicaNombreComercial, a.CLIRAZSOC PersonaJuridicaNombreLegal , 'RUT' PersonaJuridicaTipoDocumentoCodigo,
'PY' PersonaJuridicaPaisCodigo, a.CLIRUC  PersonaJuridicaDocumento , SUBSTRING( SUCSUCCOD|| '- SUC. '||SUCDENCOM,1,40) DireccionDescripcion,
    (CASE
        WHEN b.SUCESTADO = 'A' THEN 'ACTIVO'
        WHEN b.SUCESTADO = 'I' THEN 'INACTIVO'
        WHEN b.SUCESTADO = 'B' THEN 'BAJA'
     END) AS DireccionCodigoPostal,
 SUBSTRING(SUCDIRECC,1,40) DireccionCalle,
 '.' DireccionNumero, '.' DireccionApartamento, ' ' DireccionObservaciones, (SELECT RCICIUERP FROM GXFINDTA.TCMRCI WHERE RDECODDEP = b.SUCDEPTO AND RCICODCIU = b.SUCCIUDAD) DireccionCiudadCodigo,
 '3' TipoTelefonoCodigo , b.SUCTELEFO TelefonoNumero , '.' TelefonoInterno, 'PY' TelefonoPaisCodigo, b.SUCCORREO Email, '.' Web
FROM GXFINDTA.TCMCLI a
JOIN GXFINDTA.TCMSUC b
ON a.CLICLICOD = b.CLICLICOD
WHERE b.CLICLICOD = 22435/*poner del numero de cliente que se necesita*/
AND b.SUCSUCCOD = 1/*poner del numero de sucursal que se necesita*/ ;

SELECT * FROM GXSEGDTA.TSGUSR r WHERE r.SGUSRID = 'U99DCOLMAN';
select * from GXSEGDTA.TSGARU t WHERE t.SGUSRCOD = 3084;
-------------------------------
---query de movimientos de retenciones - yanini
SELECT CASE
           WHEN A.SETRETSTA = 'A' THEN 'Aprobado'
           WHEN A.SETRETSTA = 'P' THEN 'Pendiente'
           WHEN A.SETRETSTA = 'R' THEN 'REvertido'
           WHEN A.SETRETSTA = 'C' THEN 'Cancelado'
           WHEN A.SETRETSTA = 'PI' THEN 'Pendiente_incoming'
           ELSE 'Desconocido' END ESTADO,
A.SETRRNBEP NRO_REFERENCIA,A.SETFECPRO FECHA_PROCESO,A.SETIMPCOD COD_IMPUESTO,A.SETCODMCC MCC,A.SETCICLIE DOC_CLIENTE,
A.SETNOMPLA CLIENTE,A.SETRZNPRV PROVEEDOR,A.SETMVDSPA PAIS_ORIGEN,A.SETMARCA MARCA,A.SETTIPTAR TIPO_TARJETA,A.SETCODEM EMISOR,
A.SETMONTO IMPORTE_ORIGEN,A.SETLIMPAU IMPORTE_LOCAL,A.SETIMPIVA IMPORTE_IVA,A.SETIMPREN IMPORTE_RENTA,B.RETESTPRO RESPUESTA_SET,
B.RETTXTPRO,B.RETNROCMP NRO_COMPROBANTE,A.SETFECAC FECHA_ACT,A.SETUSUAC USUARIO
    FROM GXFINDTA.TCLSET A
         left JOIN GXFINDTA.TCLRET B
              ON A.SETIDRET = B.RETIDRET
WHERE A.SETFECPRO BETWEEN '20241101' AND '20241130';

SELECT * from gxfindta.tclset t
WHERE t.SETFECPRO BETWEEN '20241001' AND '20241031';

Select
*from gxfindta.tclset a JOIN  GXFINDTA.TCLRET b
ON a.SETidRet = b.RETIdRet
WHERE a.SETFecPro = '20240930'; --- trae datos

Select
*from gxfindta.tclset a JOIN  GXFINDTA.TCLRET b
ON a.SETidRet = b.RETIdRet
WHERE a.SETFecPro = '20241001'; -- NO trae datos, el campo SETidRet esta vacio en tclset
-----
--alta entidad
--TDGENT - Entidad -214

INSERT INTO GXTRJDTA.TDGENT
(ENTCODENT, ENTNMENTID, ENTNCENTID, ENTTPENTID, ENTESTADO, ENTDURACTC, ENTDURACTD, ENTFACTURA, ENTCARTERA, ENTESTINTC, ENTESTINTD, ENTCNTURGE, ENTCODCOM, ENTGENAUTC, ENTGENAUTD, ENTGENCTA, ENTGENPINC, ENTGENPIND, ENTIMPUE, ENTACCIONI, ENTUSULTUP, ENTFHULTUP, ENTCONCAMV, ENTPRECTA, ENTDOCORDC, ENTDOCORDD, ENTULTNCTA, ENTTIPOCIE, ENTCODSWFT, ENTRENGTC, ENTCMPGTD, ENTCODCLI)
VALUES(7214, 'TRANSAGRO', 'TRANSAGRO', 'EMP', 'A', 60, 60, 'S', 'N', 'I', 'I', 15, '4500224', 'S', 'S', 'S', 'B', 'B', 'S', 'N', CURRENT USER, CURRENT TIMESTAMP, 'N', 7214, 'S', 'S', 0, '', '', '', '', 0);

-- TCOENC - Entidad - Convivencia
INSERT INTO GXTRJDTA.TCOENC
(ENCENTACT, ENCENTANT, ENCUSULTUP, ENCFHULTUP, ENCENTROL)
VALUES(7214, '214', CURRENT USER, CURRENT TIMESTAMP, 721401);

--TCOEAC - Entidad Afinidad Convivencia

INSERT INTO GXTRJDTA.TCOEAC
(EACENTACT, EACENTANT, EACAFIACT, EACAFIANT, EACUSULTUP, EACFHULTUP, EACBINANT)
VALUES(7214, '214', 1, '001', CURRENT USER , CURRENT timestamp, '627431');

--tdgenm

INSERT INTO GXTRJDTA.TDGENM
(ENTCODENT, MARIDMARCA, ENMMIEMPRI, ENMIDEMISO, ENMUSUUP, ENMFHOUP)
VALUES(7214, 'DIN', 'N', 0, CURRENT USER, CURRENT TIMESTAMP);

--tdgemp

INSERT INTO GXTRJDTA.TDGEMP
(ENTCODENT, MARIDMARCA, PROIDPRODU, EMPUSULTUP, EMPFHULTUP)
VALUES(7214, 'DIN', 'CLA', CURRENT USER , CURRENT TIMESTAMP);

INSERT INTO GXTRJDTA.TDGEMP
(ENTCODENT, MARIDMARCA, PROIDPRODU, EMPUSULTUP, EMPFHULTUP)
VALUES(7214, 'DIN', 'PRE', CURRENT USER , CURRENT TIMESTAMP);

-- TDGENT - Entidad - 215

INSERT INTO GXTRJDTA.TDGENT
(ENTCODENT, ENTNMENTID, ENTNCENTID, ENTTPENTID, ENTESTADO, ENTDURACTC, ENTDURACTD, ENTFACTURA, ENTCARTERA, ENTESTINTC, ENTESTINTD, ENTCNTURGE, ENTCODCOM, ENTGENAUTC, ENTGENAUTD, ENTGENCTA, ENTGENPINC, ENTGENPIND, ENTIMPUE, ENTACCIONI, ENTUSULTUP, ENTFHULTUP, ENTCONCAMV, ENTPRECTA, ENTDOCORDC, ENTDOCORDD, ENTULTNCTA, ENTTIPOCIE, ENTCODSWFT, ENTRENGTC, ENTCMPGTD, ENTCODCLI)
VALUES(7215, 'HILAGRO', 'HILAGRO', 'EMP', 'A', 60, 60, 'S', 'N', 'I', 'I', 15, '4500225 ', 'S', 'S', 'S', 'B', 'B', 'S', 'N', CURRENT USER, CURRENT TIMESTAMP, 'N', 7215, 'S', 'S', 0, '', '', '', '', 0);

-- TCOENC - Entidad - Convivencia
INSERT INTO GXTRJDTA.TCOENC
(ENCENTACT, ENCENTANT, ENCUSULTUP, ENCFHULTUP, ENCENTROL)
VALUES(7215, '215', CURRENT USER, CURRENT TIMESTAMP, 721401);

--TCOEAC - Entidad Afinidad Convivencia

INSERT INTO GXTRJDTA.TCOEAC
(EACENTACT, EACENTANT, EACAFIACT, EACAFIANT, EACUSULTUP, EACFHULTUP, EACBINANT)
VALUES(7215, '215', 1, '001', CURRENT USER , CURRENT timestamp, '627431');

--tdgenm

INSERT INTO GXTRJDTA.TDGENM
(ENTCODENT, MARIDMARCA, ENMMIEMPRI, ENMIDEMISO, ENMUSUUP, ENMFHOUP)
VALUES(7215, 'DIN', 'N', 0, CURRENT USER, CURRENT TIMESTAMP);

--tdgemp

INSERT INTO GXTRJDTA.TDGEMP
(ENTCODENT, MARIDMARCA, PROIDPRODU, EMPUSULTUP, EMPFHULTUP)
VALUES(7215, 'DIN', 'CLA', CURRENT USER , CURRENT TIMESTAMP);

INSERT INTO GXTRJDTA.TDGEMP
(ENTCODENT, MARIDMARCA, PROIDPRODU, EMPUSULTUP, EMPFHULTUP)
VALUES(7215, 'DIN', 'PRE', CURRENT USER , CURRENT TIMESTAMP);

--tabla de usuariio para servicio
SELECT * FROM GXTRJDTA.TDSDWS T WHERE PWSUSUHAB='U99ADOLFO';

--585 cac operciones supervisor
/*7216=revervciones,
7217=motivo reversa*/
SELECT * FROM GXSEGDTA.TSGROLDT T WHERE T.SGFUNCOD=7216 AND T.SGROLCOD=585;
SELECT * FROM GXSEGDTA.TSGROLDT T WHERE T.SGFUNCOD=7217 AND T.SGROLCOD=585;

--------------------------------------------
    --Historico de Bloqueo ----
SELECT HBLESTADO,
       HBLIDMOTAU,
       SUBSTR(HBLNROTRJ, 1, 6) || 'XXXXXX' || SUBSTR(HBLNROTRJ, 13, 4),
       HBLDSCRES,
       HBLUSULTUP,
       HBLIDTBLOQ,
       HBLFECHA,
       HBLHORA
FROM GXTRJDTA.TBQHBL T
WHERE HBLNROTRJ = '5148480000637856';
----ver tc bloqueos y mas
SELECT * FROM GXTRJDTA.TATAUT t WHERE AUTCLAVE='4224102252098310';
SELECT * FROM GXTRJDTA.TATADT t  WHERE AUTIDAUTRJ='9050629';
SELECT * FROM GXTRJDTA.TMOMEP t WHERE MEPNROTRJ='4224102252098310';
SELECT * FROM GXBDBPS.AUTARAF a WHERE ATNUMTA='4224102252098310';  --- acas salto el movimiento de hoy ----
SELECT TRJFECBLO,TRJFORBLOQ,i.* FROM GXTRJDTA.ITTCTRJ i WHERE TRJNROTRJ='5148480000637856';
--td  para debito es
SELECT * FROM GXBDBPS.atdemis WHERE AECTA IN ('5205964408');
--por cuenta y si se usa reinge bloqueo
SELECT * FROM GXTRJDTA.TBQHBL t WHERE T.HBLNROTRJ LIKE '546297%' AND t.HBLFHULTUP >='2024-10-28 00:00:37.000000';
SELECT * FROM GXTRJDTA.TTDEMI t WHERE CDBIDCTA='1820464929';
SELECT * FROM GXBDBPS.TDCTA t WHERE TDCTANRO='1820464929' ;
SELECT * FROM GXBDBPS.TDCTA t WHERE TDCTANRO='1820464929';

--1-----PRIMERO SE VER ESTA TABLA PARA ARRANCAR
SELECT * FROM GXBDBPS.TDCLIENTE t WHERE TDCLINRODOC ='3656596';
--2--
SELECT * FROM GXTRJDTA.TTDEMI t WHERE CDBIDCTA='1820464929';
--3--
SELECT HBLESTADO,HBLIDMOTAU,t.* FROM GXTRJDTA.TBQHBL t WHERE HBLNROTRJ='5462970000092076';  ---Aca vemos el registros de Auditoria
--4--LUEGO VER EN NUT999
SELECT * FROM GXBDBPS.NUT999 n WHERE DBGOBJID IN ('BLOQTARJ', 'BLOQTARJMST') AND DBGMSG like  '%5462970000092076%' ;
--5--LUEGO VER EN NUT999
SELECT * FROM GXBDBPS.TRXAUDMON t WHERE TRXAUDMSJ LIKE '%5462970000092076%';
--546297******2076
------------------------------------------------------------------------------------------------------
SELECT * FROM GXFINDTA.TCMTIF T WHERE CASCODIGO=2;
--detalle del 2
SELECT * FROM GXFINDTA.TCMCAS T;